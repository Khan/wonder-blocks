"use strict";(self.webpackChunkwonder_blocks=self.webpackChunkwonder_blocks||[]).push([[9163],{"./packages/wonder-blocks-dropdown/dist/es/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{BA:()=>OptionItem,NU:()=>MultiSelect,PC:()=>ActionMenu,aW:()=>SeparatorItem,q4:()=>SingleSelect,tC:()=>ActionItem});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),aphrodite__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/aphrodite/lib/index.js"),react_router_dom__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/react-router-dom/esm/react-router-dom.js"),react_router__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/react-router/esm/react-router.js"),_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/wonder-blocks-color/dist/es/index.js"),_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/wonder-blocks-spacing/dist/es/index.js"),_khanacademy_wonder_blocks_typography__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/wonder-blocks-typography/dist/es/index.js"),_khanacademy_wonder_blocks_clickable__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/wonder-blocks-clickable/dist/es/index.js"),_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./packages/wonder-blocks-core/dist/es/index.js"),_khanacademy_wonder_blocks_icon__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./packages/wonder-blocks-icon/dist/es/index.js"),react_dom__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/react-dom/index.js"),_khanacademy_wonder_blocks_search_field__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./packages/wonder-blocks-search-field/dist/es/index.js"),_khanacademy_wonder_blocks_timing__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./packages/wonder-blocks-timing/dist/es/index.js"),react_window__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./node_modules/react-window/dist/index.esm.js"),react_popper__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./node_modules/react-popper/lib/esm/Popper.js"),_khanacademy_wonder_blocks_modal__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./packages/wonder-blocks-modal/dist/es/index.js"),_khanacademy_wonder_blocks_layout__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./packages/wonder-blocks-layout/dist/es/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}const keyCodes_tab=9,keyCodes_escape=27,keyCodes_space=32,keyCodes_up=38,keyCodes_down=40,selectDropdownStyle={marginTop:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.xSmall_8,marginBottom:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.xSmall_8},filterableDropdownStyle={minHeight:100},defaultLabels={clearSearch:"Clear search",filter:"Filter",noResults:"No results",selectNoneLabel:"Select none",selectAllLabel:numOptions=>`Select all (${numOptions})`,noneSelected:"0 items",someSelected:numSelectedValues=>`${numSelectedValues} items`,allSelected:"All items"},{blue:blue$3,white:white$4,offBlack:offBlack$3,offBlack32:offBlack32$4}=_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.default,StyledAnchor=(0,_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_6__.cu)("a"),StyledButton$2=(0,_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_6__.cu)("button"),StyledLink=(0,_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_6__.cu)(react_router_dom__WEBPACK_IMPORTED_MODULE_13__.rU);class ActionItem extends react__WEBPACK_IMPORTED_MODULE_0__.Component{static isClassOf(instance){return instance&&instance.type&&instance.type.__IS_ACTION_ITEM__}renderClickableBehavior(router){const{skipClientNav,disabled,href,target,indent,label,lang,onClick,role,style,testId}=this.props,ClickableBehavior=(0,_khanacademy_wonder_blocks_clickable__WEBPACK_IMPORTED_MODULE_5__.nJ)(href,skipClientNav,router);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(ClickableBehavior,{disabled,onClick,href,role,target},((state,childrenProps)=>{const{pressed,hovered,focused}=state,defaultStyle=[styles$8.shared,disabled&&styles$8.disabled,!disabled&&(pressed?styles$8.active:(hovered||focused)&&styles$8.focus),style],props=_extends({"data-test-id":testId,disabled,role,style:[defaultStyle]},childrenProps),children=react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_typography__WEBPACK_IMPORTED_MODULE_4__.Uc,{lang,style:[indent&&styles$8.indent,styles$8.label]},label));return href&&!disabled?router&&!skipClientNav&&(0,_khanacademy_wonder_blocks_clickable__WEBPACK_IMPORTED_MODULE_5__.J7)(href)?react__WEBPACK_IMPORTED_MODULE_0__.createElement(StyledLink,_extends({},props,{to:href}),children):react__WEBPACK_IMPORTED_MODULE_0__.createElement(StyledAnchor,_extends({},props,{href,target}),children):react__WEBPACK_IMPORTED_MODULE_0__.createElement(StyledButton$2,_extends({type:"button"},props,{disabled}),children)}))}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router__WEBPACK_IMPORTED_MODULE_14__.s6.Consumer,null,(router=>this.renderClickableBehavior(router)))}}ActionItem.displayName="ActionItem",ActionItem.defaultProps={disabled:!1,indent:!1,role:"menuitem"},ActionItem.__IS_ACTION_ITEM__=!0;const styles$8=aphrodite__WEBPACK_IMPORTED_MODULE_1__.StyleSheet.create({shared:{background:white$4,color:offBlack$3,textDecoration:"none",border:"none",outline:"none",flexDirection:"row",alignItems:"center",display:"flex",height:40,minHeight:40,paddingLeft:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.medium_16,paddingRight:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.medium_16,touchAction:"manipulation"},label:{whiteSpace:"nowrap",userSelect:"none"},indent:{marginLeft:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.medium_16},focus:{color:white$4,background:blue$3},active:{color:(0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.CD)((0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.U1)(blue$3,.32),white$4),background:(0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.CD)(offBlack32$4,blue$3)},disabled:{color:offBlack32$4,cursor:"default"}});function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}const{offBlack:offBlack$2,offBlack32:offBlack32$3,white:white$3}=_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.default,Check=function Check(props){const{disabled,selected,pressed,hovered,focused}=props;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_icon__WEBPACK_IMPORTED_MODULE_7__.Z,{icon:_khanacademy_wonder_blocks_icon__WEBPACK_IMPORTED_MODULE_7__.c.check,size:"small",color:disabled?offBlack32$3:pressed||hovered||focused?white$3:offBlack$2,style:[styles$7.bounds,!selected&&styles$7.hide]})},styles$7=aphrodite__WEBPACK_IMPORTED_MODULE_1__.StyleSheet.create({bounds:{minHeight:16,minWidth:16},hide:{visibility:"hidden"}}),checkboxCheck={small:"M11.263 4.324a1 1 0 1 1 1.474 1.352l-5.5 6a1 1 0 0 1-1.505-.036l-2.5-3a1 1 0 1 1 1.536-1.28L6.536 9.48l4.727-5.157z"},{blue:blue$2,white:white$2,offBlack16:offBlack16$1,offBlack32:offBlack32$2,offBlack50,offWhite}=_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.default,Checkbox=function Checkbox(props){const{disabled,selected,pressed,hovered,focused}=props,activeBlue=(0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.CD)(offBlack32$2,blue$2),clickInteraction=pressed||hovered||focused,bgColor=disabled?offWhite:selected&&!clickInteraction?blue$2:white$2,checkColor=disabled?offBlack32$2:clickInteraction?pressed?activeBlue:blue$2:white$2;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_6__.G7,{style:[styles$6.checkbox,(clickInteraction||selected&&!disabled)&&styles$6.noBorder,disabled&&styles$6.disabledCheckbox,{backgroundColor:bgColor}]},selected&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_icon__WEBPACK_IMPORTED_MODULE_7__.Z,{icon:checkboxCheck,size:"small",color:checkColor,style:[disabled&&selected&&styles$6.disabledCheckFormatting]}))},styles$6=aphrodite__WEBPACK_IMPORTED_MODULE_1__.StyleSheet.create({checkbox:{minHeight:16,minWidth:16,borderRadius:3,borderWidth:1,borderStyle:"solid",borderColor:offBlack50},noBorder:{borderWidth:0},disabledCheckbox:{borderColor:offBlack16$1,backgroundColor:offWhite},disabledCheckFormatting:{position:"absolute",top:-1,left:-1}}),_excluded$5=["disabled","label","role","selected","testId","style","value","onClick","onToggle","variant"];class OptionItem extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(...args){super(...args),this.handleClick=()=>{const{onClick,onToggle,value}=this.props;onToggle(value),onClick&&onClick()}}static isClassOf(instance){return instance&&instance.type&&instance.type.__IS_OPTION_ITEM__}getCheckComponent(){return"check"===this.props.variant?Check:Checkbox}render(){const _this$props=this.props,{disabled,label,role,selected,testId,style}=_this$props,sharedProps=_objectWithoutPropertiesLoose(_this$props,_excluded$5),ClickableBehavior=(0,_khanacademy_wonder_blocks_clickable__WEBPACK_IMPORTED_MODULE_5__.nJ)(),CheckComponent=this.getCheckComponent();return react__WEBPACK_IMPORTED_MODULE_0__.createElement(ClickableBehavior,{disabled,onClick:this.handleClick,role,tabIndex:0},((state,childrenProps)=>{const{pressed,hovered,focused}=state,defaultStyle=[styles$5.itemContainer,pressed?styles$5.active:(hovered||focused)&&styles$5.focus,disabled&&styles$5.disabled,style];return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_6__.G7,_extends({},sharedProps,{testId,style:defaultStyle,"aria-selected":selected?"true":"false",role},childrenProps),react__WEBPACK_IMPORTED_MODULE_0__.createElement(CheckComponent,{disabled,selected,pressed,hovered,focused}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_typography__WEBPACK_IMPORTED_MODULE_4__.Uc,{style:styles$5.label},label))}))}}OptionItem.displayName="OptionItem",OptionItem.defaultProps={disabled:!1,onToggle:()=>{},role:"option",selected:!1},OptionItem.__IS_OPTION_ITEM__=!0;const{blue:blue$1,white:white$1,offBlack:offBlack$1,offBlack32:offBlack32$1}=_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.default,styles$5=aphrodite__WEBPACK_IMPORTED_MODULE_1__.StyleSheet.create({itemContainer:{flexDirection:"row",background:white$1,color:offBlack$1,alignItems:"center",height:40,minHeight:40,border:0,outline:0,paddingLeft:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.xSmall_8,paddingRight:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.medium_16,whiteSpace:"nowrap",cursor:"default"},focus:{color:white$1,background:blue$1},active:{color:(0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.CD)((0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.U1)(blue$1,.32),white$1),background:(0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.CD)(offBlack32$1,blue$1)},disabled:{color:offBlack32$1,background:white$1},label:{whiteSpace:"nowrap",userSelect:"none",marginLeft:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.xSmall_8,overflow:"hidden",textOverflow:"ellipsis"},hide:{visibility:"hidden"}});class SeparatorItem extends react__WEBPACK_IMPORTED_MODULE_0__.Component{static isClassOf(instance){return instance&&instance.type&&instance.type.__IS_SEPARATOR_ITEM__}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_6__.G7,{style:[styles$4.separator,this.props.style],"aria-hidden":"true"})}}SeparatorItem.displayName="SeparatorItem",SeparatorItem.__IS_SEPARATOR_ITEM__=!0;const styles$4=aphrodite__WEBPACK_IMPORTED_MODULE_1__.StyleSheet.create({separator:{boxShadow:`0 -1px ${_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.default.offBlack16}`,height:1,minHeight:1,marginTop:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.xxxSmall_4,marginBottom:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.xxxSmall_4}});class DropdownOpener extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(...args){super(...args),this.getTestIdFromProps=childrenProps=>childrenProps.testId||childrenProps["data-test-id"]}renderAnchorChildren(eventState,clickableChildrenProps){const{disabled,testId,text}=this.props,renderedChildren=this.props.children(_extends({},eventState,{text})),childrenProps=renderedChildren.props,childrenTestId=this.getTestIdFromProps(childrenProps);return react__WEBPACK_IMPORTED_MODULE_0__.cloneElement(renderedChildren,_extends({},clickableChildrenProps,{disabled,onClick:childrenProps.onClick?e=>{childrenProps.onClick(e),clickableChildrenProps.onClick(e)}:clickableChildrenProps.onClick,"data-test-id":childrenTestId||testId}))}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_clickable__WEBPACK_IMPORTED_MODULE_5__.qj,{onClick:this.props.onClick,disabled:this.props.disabled},((eventState,handlers)=>this.renderAnchorChildren(eventState,handlers)))}}DropdownOpener.displayName="DropdownOpener",DropdownOpener.defaultProps={disabled:!1};class DropdownVirtualizedItem extends react__WEBPACK_IMPORTED_MODULE_0__.Component{render(){const{data,index,style}=this.props,item=data[index];if(SeparatorItem.isClassOf(item.component))return react__WEBPACK_IMPORTED_MODULE_0__.cloneElement(item.component,{style});{const{component,populatedProps,onClick,role,ref}=item;return react__WEBPACK_IMPORTED_MODULE_0__.cloneElement(component,_extends({style},populatedProps,{key:index,onClick,ref:item.focusable&&ref,role}))}}}function getDropdownMenuHeight(items,initialHeight=0){return items.slice(0,9).reduce(((sum,item)=>SeparatorItem.isClassOf(item.component)?sum+9:sum+40),initialHeight)}DropdownVirtualizedItem.displayName="DropdownVirtualizedItem";class DropdownCoreVirtualized extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.getItemSize=index=>{const item=this.props.data[index];return SeparatorItem.isClassOf(item.component)?9:40},this.state={height:getDropdownMenuHeight(props.data),width:props.width}}componentDidMount(){const{schedule}=this.props;schedule.animationFrame((()=>{this.setWidth()}))}componentDidUpdate(prevProps){const{data,listRef}=this.props;prevProps.data.length!==data.length&&(this.setHeight(),listRef&&listRef.current&&listRef.current.resetAfterIndex(1))}setWidth(){const rootNode=react_dom__WEBPACK_IMPORTED_MODULE_8__.findDOMNode(this),parentNode=null==rootNode?void 0:rootNode.parentElement;if(parentNode){const width=parentNode.getBoundingClientRect().width;this.setState({width})}}setHeight(){const height=getDropdownMenuHeight(this.props.data);this.setState({height})}renderInitialItems(){const{data}=this.props,allComponents=data.map((e=>e.component));return react__WEBPACK_IMPORTED_MODULE_0__.Children.toArray(allComponents).filter(Boolean).sort(((a,b)=>b.props.label&&a.props.label?b.props.label.length-a.props.label.length:-1)).slice(0,9).map((item=>react__WEBPACK_IMPORTED_MODULE_0__.cloneElement(item,{style:{visibility:"hidden"}})))}renderVirtualizedList(width,height){const{data,listRef}=this.props;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_window__WEBPACK_IMPORTED_MODULE_15__.S_,{height,itemCount:data.length,itemSize:this.getItemSize,itemData:data,style:{overflowX:"hidden"},width,overscanCount:5,ref:listRef},DropdownVirtualizedItem)}render(){const{width,height}=this.state;return null==width?this.renderInitialItems():this.renderVirtualizedList(width,height)}}DropdownCoreVirtualized.displayName="DropdownCoreVirtualized";var DropdownCoreVirtualized$1=(0,_khanacademy_wonder_blocks_timing__WEBPACK_IMPORTED_MODULE_10__.$K)(DropdownCoreVirtualized);const modifiers=[{name:"preventOverflow",options:{rootBoundary:"viewport",altAxis:!0,tether:!1}}],DropdownPopper=function DropdownPopper({children,alignment="left",onPopperElement,referenceElement}){const modalHost=(0,_khanacademy_wonder_blocks_modal__WEBPACK_IMPORTED_MODULE_11__.jq)(referenceElement)||document.querySelector("body");return modalHost?react_dom__WEBPACK_IMPORTED_MODULE_8__.createPortal(react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_popper__WEBPACK_IMPORTED_MODULE_16__.r,{innerRef:node=>{node&&onPopperElement&&onPopperElement(node)},referenceElement,strategy:"fixed",placement:"left"===alignment?"bottom-start":"bottom-end",modifiers},(({placement,ref,style,hasPopperEscaped,isReferenceHidden})=>{const shouldHidePopper=!(!hasPopperEscaped&&!isReferenceHidden);return react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{ref,style,"data-test-id":"dropdown-popper","data-placement":placement},children(shouldHidePopper))})),modalHost):null};const StyledSpan=(0,_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_6__.cu)("span");class DropdownCore extends react__WEBPACK_IMPORTED_MODULE_0__.Component{static sameItemsFocusable(prevItems,currentItems){if(prevItems.length!==currentItems.length)return!1;for(let i=0;i<prevItems.length;i++)if(prevItems[i].focusable!==currentItems[i].focusable)return!1;return!0}static getDerivedStateFromProps(props,state){if(0===state.itemRefs.length&&props.open||!DropdownCore.sameItemsFocusable(state.prevItems,props.items)){const itemRefs=[];for(let i=0;i<props.items.length;i++)if(props.items[i].focusable){const ref=react__WEBPACK_IMPORTED_MODULE_0__.createRef();itemRefs.push({ref,originalIndex:i})}return{itemRefs,prevItems:props.items,sameItemsFocusable:!1}}return{prevItems:props.items,sameItemsFocusable:!0}}constructor(props){super(props),this.focusedIndex=void 0,this.focusedOriginalIndex=void 0,this.itemsClicked=void 0,this.popperElement=void 0,this.virtualizedListRef=void 0,this.handleKeyDownDebounced=void 0,this.textSuggestion=void 0,this.searchFieldRef=react__WEBPACK_IMPORTED_MODULE_0__.createRef(),this.handleInteract=event=>{const{open,onOpenChanged}=this.props,target=event.target,thisElement=react_dom__WEBPACK_IMPORTED_MODULE_8__.findDOMNode(this);open&&thisElement&&!thisElement.contains(target)&&this.popperElement&&!this.popperElement.contains(target)&&onOpenChanged(!1)},this.handleKeyDown=event=>{const{enableTypeAhead,onOpenChanged,open,searchText}=this.props,keyCode=event.which||event.keyCode;if(enableTypeAhead&&function getStringForKey(key){return 1!==key.length&&/^[A-Z]/i.test(key)?"":key}(event.key)&&(event.stopPropagation(),this.textSuggestion+=event.key,this.handleKeyDownDebounced(this.textSuggestion)),!open)return keyCode===keyCodes_down?(event.preventDefault(),void onOpenChanged(!0)):void 0;switch(keyCode){case keyCodes_tab:if(this.isSearchFieldFocused()&&searchText)return;return this.restoreTabOrder(),void onOpenChanged(!1);case keyCodes_space:if(this.isSearchFieldFocused())return;return void event.preventDefault();case keyCodes_up:return event.preventDefault(),void this.focusPreviousItem();case keyCodes_down:return event.preventDefault(),void this.focusNextItem()}},this.handleKeyUp=event=>{const{onOpenChanged,open}=this.props;switch(event.which||event.keyCode){case keyCodes_space:if(this.isSearchFieldFocused())return;return void event.preventDefault();case keyCodes_escape:return void(open&&(event.stopPropagation(),this.restoreTabOrder(),onOpenChanged(!1)))}},this.handleKeyDownDebounceResult=key=>{const foundIndex=this.props.items.filter((item=>item.focusable)).findIndex((({component})=>{var _component$props;if(SeparatorItem.isClassOf(component))return!1;return(null==(_component$props=component.props)?void 0:_component$props.label.toLowerCase()).startsWith(key.toLowerCase())}));if(foundIndex>=0){const isClosed=!this.props.open;isClosed&&this.props.onOpenChanged(!0),this.focusedIndex=foundIndex,this.scheduleToFocusCurrentItem((node=>{"single"===this.props.selectionType&&isClosed&&node&&(node.click(),this.props.onOpenChanged(!1))}))}this.textSuggestion=""},this.handleClickFocus=index=>{this.itemsClicked=!0,this.focusedIndex=index,this.focusedOriginalIndex=this.state.itemRefs[this.focusedIndex].originalIndex},this.handleDropdownMouseUp=event=>{event.nativeEvent.stopImmediatePropagation?event.nativeEvent.stopImmediatePropagation():event.stopPropagation()},this.handleItemClick=(focusIndex,item)=>{this.handleClickFocus(focusIndex),item.component.props.onClick&&item.component.props.onClick(),item.populatedProps.onClick&&item.populatedProps.onClick()},this.handleSearchTextChanged=searchText=>{const{onSearchTextChanged}=this.props;onSearchTextChanged&&onSearchTextChanged(searchText)},this.resetFocusedIndex(),this.state={prevItems:this.props.items,itemRefs:[],sameItemsFocusable:!1,labels:_extends({noResults:defaultLabels.noResults,someResults:defaultLabels.someSelected},props.labels)},this.virtualizedListRef=react__WEBPACK_IMPORTED_MODULE_0__.createRef(),this.handleKeyDownDebounced=function debounce(callback,wait){let timeout;return function executedFunction(...args){clearTimeout(timeout),timeout=setTimeout((()=>{clearTimeout(timeout),callback(...args)}),wait)}}(this.handleKeyDownDebounceResult,500),this.textSuggestion=""}componentDidMount(){this.updateEventListeners(),this.maybeFocusInitialItem()}componentDidUpdate(prevProps){const{open}=this.props;if(prevProps.open!==open)this.updateEventListeners(),this.maybeFocusInitialItem();else if(open){const{itemRefs,sameItemsFocusable}=this.state;if(sameItemsFocusable)return;{const newFocusableIndex=itemRefs.findIndex((ref=>ref.originalIndex===this.focusedOriginalIndex));-1===newFocusableIndex?(this.focusedIndex=0,this.itemsClicked=!1,this.scheduleToFocusCurrentItem()):this.focusedIndex=newFocusableIndex}this.props.labels!==prevProps.labels&&this.setState({labels:_extends({},this.state.labels,this.props.labels)})}}componentWillUnmount(){this.removeEventListeners()}resetFocusedIndex(){const{initialFocusedIndex}=this.props;if(void 0!==initialFocusedIndex)this.focusedIndex=initialFocusedIndex;else{if(this.hasSearchField()&&!this.isSearchFieldFocused())return this.focusSearchField();this.focusedIndex=0}}maybeFocusInitialItem(){const{autoFocus,open}=this.props;autoFocus&&(open?(this.resetFocusedIndex(),this.scheduleToFocusCurrentItem()):open||(this.itemsClicked=!1))}updateEventListeners(){this.props.open?this.addEventListeners():this.removeEventListeners()}addEventListeners(){document.addEventListener("mouseup",this.handleInteract),document.addEventListener("touchend",this.handleInteract)}removeEventListeners(){document.removeEventListener("mouseup",this.handleInteract),document.removeEventListener("touchend",this.handleInteract)}scheduleToFocusCurrentItem(onFocus){this.shouldVirtualizeList()?this.props.schedule.animationFrame((()=>{this.focusCurrentItem(onFocus)})):this.focusCurrentItem(onFocus)}focusCurrentItem(onFocus){const focusedItemRef=this.state.itemRefs[this.focusedIndex];if(focusedItemRef){this.virtualizedListRef.current&&this.virtualizedListRef.current.scrollToItem(focusedItemRef.originalIndex);const node=react_dom__WEBPACK_IMPORTED_MODULE_8__.findDOMNode(focusedItemRef.ref.current);node&&(node.focus(),this.focusedOriginalIndex=focusedItemRef.originalIndex,onFocus&&onFocus(node))}}focusSearchField(){this.searchFieldRef.current&&this.searchFieldRef.current.focus()}hasSearchField(){return!!this.props.isFilterable}isSearchFieldFocused(){return this.hasSearchField()&&document.activeElement===this.searchFieldRef.current}focusPreviousItem(){if(0===this.focusedIndex){if(this.hasSearchField()&&!this.isSearchFieldFocused())return this.focusSearchField();this.focusedIndex=this.state.itemRefs.length-1}else this.focusedIndex-=1;this.scheduleToFocusCurrentItem()}focusNextItem(){if(this.focusedIndex===this.state.itemRefs.length-1){if(this.hasSearchField()&&!this.isSearchFieldFocused())return this.focusSearchField();this.focusedIndex=0}else this.focusedIndex+=1;this.scheduleToFocusCurrentItem()}restoreTabOrder(){this.props.openerElement&&this.props.openerElement.focus()}getItemRole(){const{role}=this.props;switch(role){case"listbox":return"option";case"menu":return"menuitem";default:throw new Error(`Expected "listbox" or "menu" for role, but receieved "${role}" instead.`)}}maybeRenderNoResults(){const{items,labels:{noResults}}=this.props;return 0===items.length?react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_typography__WEBPACK_IMPORTED_MODULE_4__.Uc,{style:styles$3.noResult,testId:"dropdown-core-no-results"},noResults):null}shouldVirtualizeList(){return this.props.items.length>125}renderList(){let focusCounter=0;const itemRole=this.getItemRole();return this.props.items.map(((item,index)=>{if(SeparatorItem.isClassOf(item.component))return item.component;const{component,focusable,populatedProps}=item;focusable&&(focusCounter+=1);const focusIndex=focusCounter-1,currentRef=this.state.itemRefs[focusIndex]?this.state.itemRefs[focusIndex].ref:null;return react__WEBPACK_IMPORTED_MODULE_0__.cloneElement(component,_extends({},populatedProps,{key:index,onClick:()=>{this.handleItemClick(focusIndex,item)},ref:focusable?currentRef:null,role:itemRole}))}))}parseVirtualizedItems(){let focusCounter=0;const itemRole=this.getItemRole();return this.props.items.map(((item,index)=>{!SeparatorItem.isClassOf(item.component)&&item.focusable&&(focusCounter+=1);const focusIndex=focusCounter-1;return _extends({},item,{role:itemRole,ref:item.focusable&&this.state.itemRefs[focusIndex]?this.state.itemRefs[focusIndex].ref:null,onClick:()=>{this.handleItemClick(focusIndex,item)}})}))}renderVirtualizedList(){const virtualizedItems=this.parseVirtualizedItems();return react__WEBPACK_IMPORTED_MODULE_0__.createElement(DropdownCoreVirtualized$1,{data:virtualizedItems,listRef:this.virtualizedListRef})}renderSearchField(){const{searchText}=this.props,{labels}=this.state;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_search_field__WEBPACK_IMPORTED_MODULE_9__.Z,{clearAriaLabel:labels.clearSearch,onChange:this.handleSearchTextChanged,placeholder:labels.filter,ref:this.searchFieldRef,style:styles$3.searchInputStyle,value:searchText||""})}renderDropdownMenu(listRenderer,isReferenceHidden){const{dropdownStyle,light,openerElement}=this.props,openerStyle=openerElement&&window.getComputedStyle(openerElement),minDropdownWidth=openerStyle?openerStyle.getPropertyValue("width"):0,maxDropdownHeight=getDropdownMenuHeight(this.props.items);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_6__.G7,{onMouseUp:this.handleDropdownMouseUp,style:[styles$3.dropdown,light&&styles$3.light,isReferenceHidden&&styles$3.hidden,dropdownStyle],testId:"dropdown-core-container"},this.props.isFilterable&&this.renderSearchField(),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_6__.G7,{role:this.props.role,style:[styles$3.listboxOrMenu,(minWidth=minDropdownWidth,maxHeight=maxDropdownHeight,aphrodite__WEBPACK_IMPORTED_MODULE_1__.StyleSheet.create({dropdownMenu:{minWidth,maxHeight}}).dropdownMenu)]},listRenderer),this.maybeRenderNoResults());var minWidth,maxHeight}renderDropdown(){const{alignment,openerElement}=this.props,listRenderer=this.shouldVirtualizeList()?this.renderVirtualizedList():this.renderList();return react__WEBPACK_IMPORTED_MODULE_0__.createElement(DropdownPopper,{alignment,onPopperElement:popperElement=>{this.popperElement=popperElement},referenceElement:openerElement},(isReferenceHidden=>this.renderDropdownMenu(listRenderer,isReferenceHidden)))}renderLiveRegion(){const{items,open}=this.props,{labels}=this.state,totalItems=items.length;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(StyledSpan,{"aria-live":"polite","aria-atomic":"true","aria-relevant":"additions text",style:styles$3.srOnly,"data-test-id":"dropdown-live-region"},open&&labels.someResults(totalItems))}render(){const{open,opener,style,className}=this.props;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_6__.G7,{onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,style:[styles$3.menuWrapper,style],className},this.renderLiveRegion(),opener,open&&this.renderDropdown())}}DropdownCore.displayName="DropdownCore",DropdownCore.defaultProps={alignment:"left",autoFocus:!0,enableTypeAhead:!0,labels:{clearSearch:defaultLabels.clearSearch,filter:defaultLabels.filter,noResults:defaultLabels.noResults,someResults:defaultLabels.someSelected},light:!1,selectionType:"single"};const styles$3=aphrodite__WEBPACK_IMPORTED_MODULE_1__.StyleSheet.create({menuWrapper:{width:"fit-content"},dropdown:{backgroundColor:_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.default.white,borderRadius:4,paddingTop:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.xxxSmall_4,paddingBottom:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.xxxSmall_4,border:`solid 1px ${_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.default.offBlack16}`,boxShadow:`0px 8px 8px 0px ${(0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.U1)(_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.default.offBlack,.1)}`},light:{border:"none"},listboxOrMenu:{overflowY:"auto"},hidden:{pointerEvents:"none",visibility:"hidden"},noResult:{color:_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.default.offBlack64,alignSelf:"center",marginTop:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.xxSmall_6},searchInputStyle:{margin:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.xSmall_8,marginTop:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.xxxSmall_4,minHeight:"auto"},srOnly:{border:0,clip:"rect(0,0,0,0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",width:1}});var DropdownCore$1=(0,_khanacademy_wonder_blocks_timing__WEBPACK_IMPORTED_MODULE_10__.$K)(DropdownCore);const _excluded$4=["children","disabled","focused","hovered","pressed","waiting","testId","opened","aria-label"],StyledButton$1=(0,_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_6__.cu)("button");class ActionMenuOpenerCore extends react__WEBPACK_IMPORTED_MODULE_0__.Component{render(){const _this$props=this.props,{children,disabled:disabledProp,focused,hovered,pressed,testId,opened,"aria-label":ariaLabel}=_this$props,restProps=_objectWithoutPropertiesLoose(_this$props,_excluded$4),buttonColor=_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.qe.controlDefault,buttonStyles=_generateStyles$1(buttonColor),disabled=disabledProp,defaultStyle=[sharedStyles.shared,disabled&&sharedStyles.disabled,buttonStyles.default,disabled&&buttonStyles.disabled,!disabled&&pressed&&buttonStyles.active],label=react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_typography__WEBPACK_IMPORTED_MODULE_4__.D9,{style:sharedStyles.text},children);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(StyledButton$1,_extends({"aria-expanded":opened?"true":"false","aria-haspopup":"menu","aria-label":ariaLabel,disabled,style:defaultStyle,type:"button"},restProps,{"data-test-id":testId}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_6__.G7,{style:!disabled&&(hovered||focused)&&buttonStyles.focus},label),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_layout__WEBPACK_IMPORTED_MODULE_12__.x9,{size:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.xxxSmall_4}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_icon__WEBPACK_IMPORTED_MODULE_7__.Z,{size:"small",color:"currentColor",icon:_khanacademy_wonder_blocks_icon__WEBPACK_IMPORTED_MODULE_7__.c.caretDown}))}}ActionMenuOpenerCore.displayName="ActionMenuOpenerCore";const sharedStyles=aphrodite__WEBPACK_IMPORTED_MODULE_1__.StyleSheet.create({shared:{position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"center",height:40,border:"none",borderRadius:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.xxxSmall_4,cursor:"pointer",outline:"none",textDecoration:"none",boxSizing:"border-box",touchAction:"manipulation",":focus":{WebkitTapHighlightColor:"rgba(0,0,0,0)"}},disabled:{cursor:"auto"},small:{height:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.xLarge_32},text:{textAlign:"left",display:"inline-block",alignItems:"center",fontWeight:"bold",userSelect:"none",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",pointerEvents:"none"},hiddenText:{visibility:"hidden"},spinner:{position:"absolute"}}),styles$2={},_generateStyles$1=color=>{const buttonType=color;if(styles$2[buttonType])return styles$2[buttonType];const{offBlack32}=_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.default;let newStyles={};return newStyles={default:{background:"none",color},focus:{":after":{content:"''",position:"absolute",height:2,left:0,right:0,bottom:-1,background:"currentColor",borderRadius:2}},active:{color:(0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.CD)(offBlack32,color)},disabled:{color:offBlack32,cursor:"default"}},styles$2[buttonType]=aphrodite__WEBPACK_IMPORTED_MODULE_1__.StyleSheet.create(newStyles),styles$2[buttonType]},_excluded$3=["text"];class ActionMenu extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(...args){super(...args),this.openerElement=void 0,this.state={opened:!1},this.handleItemSelected=()=>{this.handleOpenChanged(!1),this.openerElement&&this.openerElement.focus()},this.handleOpenChanged=opened=>{this.setState({opened}),this.props.onToggle&&this.props.onToggle(opened)},this.handleOptionSelected=selectedValue=>{const{onChange,selectedValues}=this.props;if(onChange&&selectedValues){if(selectedValues.includes(selectedValue)){const index=selectedValues.indexOf(selectedValue);onChange([...selectedValues.slice(0,index),...selectedValues.slice(index+1)])}else onChange([...selectedValues,selectedValue]);this.handleItemSelected()}},this.handleOpenerRef=node=>{this.openerElement=react_dom__WEBPACK_IMPORTED_MODULE_8__.findDOMNode(node)},this.handleClick=e=>{this.handleOpenChanged(!this.state.opened)}}static getDerivedStateFromProps(props,state){return{opened:"boolean"==typeof props.opened?props.opened:state.opened}}getMenuItems(){const{children,selectedValues}=this.props,allChildren=react__WEBPACK_IMPORTED_MODULE_0__.Children.toArray(children).filter(Boolean),isOptionItemIncluded=allChildren.some((item=>OptionItem.isClassOf(item)));return allChildren.map((item=>{const{value,disabled}=item.props,itemObject={component:item,focusable:!(!ActionItem.isClassOf(item)&&!OptionItem.isClassOf(item))&&!disabled,populatedProps:{}};return ActionItem.isClassOf(item)?_extends({},itemObject,{populatedProps:{indent:isOptionItemIncluded,onClick:this.handleItemSelected}}):OptionItem.isClassOf(item)?_extends({},itemObject,{populatedProps:{onToggle:this.handleOptionSelected,selected:!!selectedValues&&selectedValues.includes(value),variant:"check"}}):itemObject}))}renderOpener(numItems){const{disabled,menuText,opener,testId}=this.props,{opened}=this.state;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(DropdownOpener,{onClick:this.handleClick,disabled:0===numItems||disabled,text:menuText,ref:this.handleOpenerRef,testId:opener?void 0:testId},opener||(openerProps=>{const eventState=_objectWithoutPropertiesLoose(openerProps,_excluded$3);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(ActionMenuOpenerCore,_extends({},eventState,{disabled,opened:!!opened,testId}),menuText)}))}render(){const{alignment,dropdownStyle,style,className}=this.props,items=this.getMenuItems(),dropdownOpener=this.renderOpener(items.length);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(DropdownCore$1,{role:"menu",style,className,opener:dropdownOpener,alignment,open:this.state.opened,items,openerElement:this.openerElement,onOpenChanged:this.handleOpenChanged,dropdownStyle:[styles$1.menuTopSpace,dropdownStyle]})}}ActionMenu.displayName="ActionMenu",ActionMenu.defaultProps={alignment:"left",disabled:!1};const styles$1=aphrodite__WEBPACK_IMPORTED_MODULE_1__.StyleSheet.create({caret:{marginLeft:4},opener:{whiteSpace:"nowrap",userSelect:"none",overflow:"hidden",textOverflow:"ellipsis"},menuTopSpace:{top:-4}}),_excluded$2=["children","disabled","id","isPlaceholder","light","open","testId","onOpenChanged"],StyledButton=(0,_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_6__.cu)("button"),{blue,white,white50,offBlack,offBlack16,offBlack32,offBlack64}=_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.default;class SelectOpener extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(...args){super(...args),this.handleClick=e=>{const{open}=this.props;this.props.onOpenChanged(!open)}}renderClickableBehavior(router){const _this$props=this.props,{children,disabled,id,isPlaceholder,light,open,testId}=_this$props,sharedProps=_objectWithoutPropertiesLoose(_this$props,_excluded$2),ClickableBehavior=(0,_khanacademy_wonder_blocks_clickable__WEBPACK_IMPORTED_MODULE_5__.nJ)(router);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(ClickableBehavior,{disabled,onClick:this.handleClick},((state,childrenProps)=>{const stateStyles=_generateStyles(light,isPlaceholder),{hovered,focused,pressed}=state,iconColor=light?disabled||pressed?"currentColor":white:disabled?offBlack32:offBlack64,style=[styles.shared,stateStyles.default,disabled&&stateStyles.disabled,!disabled&&(pressed?stateStyles.active:(hovered||focused)&&stateStyles.focus)];return react__WEBPACK_IMPORTED_MODULE_0__.createElement(StyledButton,_extends({},sharedProps,{"aria-expanded":open?"true":"false","aria-haspopup":"listbox","data-test-id":testId,disabled,id,style,type:"button"},childrenProps),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_typography__WEBPACK_IMPORTED_MODULE_4__.Uc,{style:styles.text},children||" "),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_icon__WEBPACK_IMPORTED_MODULE_7__.Z,{icon:_khanacademy_wonder_blocks_icon__WEBPACK_IMPORTED_MODULE_7__.c.caretDown,color:iconColor,size:"small",style:styles.caret,"aria-hidden":"true"}))}))}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router__WEBPACK_IMPORTED_MODULE_14__.s6.Consumer,null,(router=>this.renderClickableBehavior(router)))}}SelectOpener.displayName="SelectOpener",SelectOpener.defaultProps={disabled:!1,light:!1,isPlaceholder:!1};const styles=aphrodite__WEBPACK_IMPORTED_MODULE_1__.StyleSheet.create({shared:{position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"space-between",color:offBlack,height:40,paddingLeft:16,paddingRight:12,borderWidth:0,borderRadius:4,borderStyle:"solid",outline:"none",textDecoration:"none",boxSizing:"border-box",whiteSpace:"nowrap",touchAction:"manipulation"},text:{marginRight:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_3__.Z.xSmall_8,whiteSpace:"nowrap",userSelect:"none",overflow:"hidden",textOverflow:"ellipsis"},caret:{minWidth:16}}),stateStyles={},_generateStyles=(light,placeholder)=>{const styleKey=`${String(light)}-${String(placeholder)}`;if(stateStyles[styleKey])return stateStyles[styleKey];let newStyles={};return newStyles=light?{default:{background:"transparent",color:placeholder?white50:white,borderColor:white50,borderWidth:1},focus:{borderColor:white,borderWidth:2,paddingLeft:15,paddingRight:11},active:{paddingLeft:15,paddingRight:11,borderColor:(0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.CD)((0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.U1)(blue,.32),white),borderWidth:2,color:placeholder?(0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.CD)((0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.U1)(white,.32),blue):(0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.CD)((0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.U1)(blue,.32),white),backgroundColor:(0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.CD)(offBlack32,blue)},disabled:{borderColor:(0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.CD)((0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.U1)(white,.32),blue),color:(0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.CD)((0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.U1)(white,.32),blue),cursor:"auto"}}:{default:{background:white,borderColor:offBlack16,borderWidth:1,color:placeholder?offBlack64:offBlack},focus:{borderColor:blue,borderWidth:2,paddingLeft:15,paddingRight:11},active:{background:(0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.CD)((0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.U1)(blue,.32),white),borderColor:(0,_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.CD)(offBlack32,blue),borderWidth:2,paddingLeft:15,paddingRight:11},disabled:{background:_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_2__.default.offWhite,borderColor:offBlack16,color:offBlack64,cursor:"auto"}},stateStyles[styleKey]=aphrodite__WEBPACK_IMPORTED_MODULE_1__.StyleSheet.create(newStyles),stateStyles[styleKey]},_excluded$1=["children","disabled","id","light","opener","placeholder","selectedValue","testId","alignment","autoFocus","dropdownStyle","enableTypeAhead","isFilterable","labels","onChange","onToggle","opened","style","className"];class SingleSelect extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.selectedIndex=void 0,this.handleOpenChanged=opened=>{this.setState({open:opened,searchText:""}),this.props.onToggle&&this.props.onToggle(opened)},this.handleToggle=selectedValue=>{selectedValue!==this.props.selectedValue&&this.props.onChange(selectedValue),this.state.open&&this.state.openerElement&&this.state.openerElement.focus(),this.setState({open:!1}),this.props.onToggle&&this.props.onToggle(!1)},this.mapOptionItemsToDropdownItems=children=>{let indexCounter=0;return this.selectedIndex=0,children.map((option=>{const{selectedValue}=this.props,{disabled,value}=option.props,selected=selectedValue===value;return selected&&(this.selectedIndex=indexCounter),disabled||(indexCounter+=1),{component:option,focusable:!disabled,populatedProps:{onToggle:this.handleToggle,selected,variant:"check"}}}))},this.handleSearchTextChanged=searchText=>{this.setState({searchText})},this.handleOpenerRef=node=>{const openerElement=react_dom__WEBPACK_IMPORTED_MODULE_8__.findDOMNode(node);this.setState({openerElement})},this.handleClick=e=>{this.handleOpenChanged(!this.state.open)},this.selectedIndex=0,this.state={open:!1,searchText:""}}static getDerivedStateFromProps(props,state){return{open:"boolean"==typeof props.opened?props.opened:state.open}}filterChildren(children){const{searchText}=this.state,lowercasedSearchText=searchText.toLowerCase();return children.filter((({props})=>!searchText||props.label.toLowerCase().indexOf(lowercasedSearchText)>-1))}getMenuItems(children){const{isFilterable}=this.props;return this.mapOptionItemsToDropdownItems(isFilterable?this.filterChildren(children):children)}renderOpener(numItems){const _this$props=this.props,{children,disabled,id,light,opener,placeholder,selectedValue,testId}=_this$props,sharedProps=_objectWithoutPropertiesLoose(_this$props,_excluded$1),selectedItem=react__WEBPACK_IMPORTED_MODULE_0__.Children.toArray(children).find((option=>option.props.value===selectedValue)),menuText=selectedItem?selectedItem.props.label:placeholder;return opener?react__WEBPACK_IMPORTED_MODULE_0__.createElement(DropdownOpener,{onClick:this.handleClick,disabled:0===numItems||disabled,ref:this.handleOpenerRef,text:menuText},opener):react__WEBPACK_IMPORTED_MODULE_0__.createElement(SelectOpener,_extends({},sharedProps,{disabled:0===numItems||disabled,id,isPlaceholder:!selectedItem,light,onOpenChanged:this.handleOpenChanged,open:this.state.open,ref:this.handleOpenerRef,testId}),menuText)}render(){const{alignment,autoFocus,children,className,dropdownStyle,enableTypeAhead,isFilterable,labels,light,style}=this.props,{searchText}=this.state,allChildren=react__WEBPACK_IMPORTED_MODULE_0__.Children.toArray(children).filter(Boolean),items=this.getMenuItems(allChildren),opener=this.renderOpener(allChildren.length);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(DropdownCore$1,{role:"listbox",selectionType:"single",alignment,autoFocus,enableTypeAhead,dropdownStyle:[isFilterable&&filterableDropdownStyle,selectDropdownStyle,dropdownStyle],initialFocusedIndex:this.selectedIndex,items,light,onOpenChanged:this.handleOpenChanged,open:this.state.open,opener,openerElement:this.state.openerElement,style,className,isFilterable,onSearchTextChanged:isFilterable?this.handleSearchTextChanged:void 0,searchText:isFilterable?searchText:"",labels})}}SingleSelect.displayName="SingleSelect",SingleSelect.defaultProps={alignment:"left",autoFocus:!0,disabled:!1,enableTypeAhead:!0,light:!1,labels:{clearSearch:defaultLabels.clearSearch,filter:defaultLabels.filter,noResults:defaultLabels.noResults,someResults:defaultLabels.someSelected}};const _excluded=["disabled","id","light","opener","testId","alignment","dropdownStyle","implicitAllEnabled","isFilterable","labels","onChange","onToggle","opened","selectedValues","shortcuts","style","className"];class MultiSelect extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.labels=void 0,this.handleOpenChanged=opened=>{this.setState({open:opened,searchText:"",lastSelectedValues:this.props.selectedValues}),this.props.onToggle&&this.props.onToggle(opened)},this.handleToggle=selectedValue=>{const{onChange,selectedValues}=this.props;if(selectedValues.includes(selectedValue)){const index=selectedValues.indexOf(selectedValue);onChange([...selectedValues.slice(0,index),...selectedValues.slice(index+1)])}else onChange([...selectedValues,selectedValue])},this.handleSelectAll=()=>{const{children,onChange}=this.props;onChange(react__WEBPACK_IMPORTED_MODULE_0__.Children.toArray(children).filter(Boolean).map((option=>option.props.value)))},this.handleSelectNone=()=>{const{onChange}=this.props;onChange([])},this.mapOptionItemToDropdownItem=option=>{const{selectedValues}=this.props,{disabled,value}=option.props;return{component:option,focusable:!disabled,populatedProps:{onToggle:this.handleToggle,selected:selectedValues.includes(value),variant:"checkbox"}}},this.handleOpenerRef=node=>{const openerElement=react_dom__WEBPACK_IMPORTED_MODULE_8__.findDOMNode(node);this.setState({openerElement})},this.handleSearchTextChanged=searchText=>{this.setState({searchText})},this.handleClick=e=>{this.handleOpenChanged(!this.state.open)},this.state={open:!1,searchText:"",lastSelectedValues:[],labels:_extends({},defaultLabels,props.labels)},this.labels=_extends({},defaultLabels,props.labels)}static getDerivedStateFromProps(props,state){return{open:"boolean"==typeof props.opened?props.opened:state.open}}componentDidUpdate(prevProps){this.props.labels!==prevProps.labels&&this.setState({labels:_extends({},this.state.labels,this.props.labels)})}getMenuText(children){const{implicitAllEnabled,selectedValues}=this.props,{noneSelected,someSelected,allSelected}=this.state.labels,noSelectionText=implicitAllEnabled?allSelected:noneSelected;switch(selectedValues.length){case 0:return noSelectionText;case 1:const selectedItem=children.find((option=>option.props.value===selectedValues[0]));return selectedItem?selectedItem.props.label:noSelectionText;case children.length:return allSelected;default:return someSelected(selectedValues.length)}}getShortcuts(numOptions){const{selectedValues,shortcuts}=this.props,{selectAllLabel,selectNoneLabel}=this.state.labels;if(shortcuts&&!this.state.searchText){const selectAllDisabled=numOptions===selectedValues.length,selectAll={component:react__WEBPACK_IMPORTED_MODULE_0__.createElement(ActionItem,{disabled:selectAllDisabled,label:selectAllLabel(numOptions),indent:!0,onClick:this.handleSelectAll}),focusable:!selectAllDisabled,populatedProps:{}},selectNoneDisabled=0===selectedValues.length;return[selectAll,{component:react__WEBPACK_IMPORTED_MODULE_0__.createElement(ActionItem,{disabled:selectNoneDisabled,label:selectNoneLabel,indent:!0,onClick:this.handleSelectNone}),focusable:!selectNoneDisabled,populatedProps:{}},{component:react__WEBPACK_IMPORTED_MODULE_0__.createElement(SeparatorItem,{key:"shortcuts-separator"}),focusable:!1,populatedProps:{}}]}return[]}getMenuItems(children){const{isFilterable}=this.props;if(!isFilterable)return children.map(this.mapOptionItemToDropdownItem);const{searchText,lastSelectedValues}=this.state,lowercasedSearchText=searchText.toLowerCase(),filteredChildren=children.filter((({props})=>!searchText||props.label.toLowerCase().indexOf(lowercasedSearchText)>-1)),lastSelectedChildren=[],restOfTheChildren=[];for(const child of filteredChildren)lastSelectedValues.includes(child.props.value)?lastSelectedChildren.push(child):restOfTheChildren.push(child);const lastSelectedItems=lastSelectedChildren.map(this.mapOptionItemToDropdownItem);return lastSelectedChildren.length&&restOfTheChildren.length&&lastSelectedItems.push({component:react__WEBPACK_IMPORTED_MODULE_0__.createElement(SeparatorItem,{key:"selected-separator"}),focusable:!1,populatedProps:{}}),[...lastSelectedItems,...restOfTheChildren.map(this.mapOptionItemToDropdownItem)]}renderOpener(allChildren){const _this$props=this.props,{disabled,id,light,opener,testId}=_this$props,sharedProps=_objectWithoutPropertiesLoose(_this$props,_excluded),{noneSelected}=this.state.labels,menuText=this.getMenuText(allChildren),numOptions=allChildren.length;return opener?react__WEBPACK_IMPORTED_MODULE_0__.createElement(DropdownOpener,{onClick:this.handleClick,disabled:0===numOptions||disabled,ref:this.handleOpenerRef,text:menuText},opener):react__WEBPACK_IMPORTED_MODULE_0__.createElement(SelectOpener,_extends({},sharedProps,{disabled:0===numOptions||disabled,id,isPlaceholder:menuText===noneSelected,light,onOpenChanged:this.handleOpenChanged,open:this.state.open,ref:this.handleOpenerRef,testId}),menuText)}render(){const{alignment,light,style,className,dropdownStyle,children,isFilterable}=this.props,{open,searchText}=this.state,{clearSearch,filter,noResults,someSelected}=this.state.labels,allChildren=react__WEBPACK_IMPORTED_MODULE_0__.Children.toArray(children).filter(Boolean),numOptions=allChildren.length,filteredItems=this.getMenuItems(allChildren),opener=this.renderOpener(allChildren);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(DropdownCore$1,{role:"listbox",alignment,dropdownStyle:[isFilterable&&filterableDropdownStyle,selectDropdownStyle,dropdownStyle],isFilterable,items:[...this.getShortcuts(numOptions),...filteredItems],light,onOpenChanged:this.handleOpenChanged,open,opener,openerElement:this.state.openerElement,selectionType:"multi",style,className,onSearchTextChanged:isFilterable?this.handleSearchTextChanged:void 0,searchText:isFilterable?searchText:"",labels:{clearSearch,filter,noResults,someResults:someSelected}})}}MultiSelect.displayName="MultiSelect",MultiSelect.defaultProps={alignment:"left",disabled:!1,light:!1,shortcuts:!1,selectedValues:[]},ActionItem.__docgenInfo={description:"",methods:[{name:"isClassOf",docblock:null,modifiers:["static"],params:[{name:"instance",type:null}],returns:null},{name:"renderClickableBehavior",docblock:null,modifiers:[],params:[{name:"router",type:null}],returns:null}],displayName:"ActionItem",props:{disabled:{defaultValue:{value:"false",computed:!1},required:!1},indent:{defaultValue:{value:"false",computed:!1},required:!1},role:{defaultValue:{value:'"menuitem"',computed:!1},required:!1}}},ActionMenu.__docgenInfo={description:"",methods:[{name:"getMenuItems",docblock:null,modifiers:[],params:[],returns:null},{name:"renderOpener",docblock:null,modifiers:[],params:[{name:"numItems",type:null}],returns:null}],displayName:"ActionMenu",props:{alignment:{defaultValue:{value:'"left"',computed:!1},required:!1},disabled:{defaultValue:{value:"false",computed:!1},required:!1}}},MultiSelect.__docgenInfo={description:"",methods:[{name:"getMenuText",docblock:null,modifiers:[],params:[{name:"children",type:null}],returns:null},{name:"getShortcuts",docblock:null,modifiers:[],params:[{name:"numOptions",type:null}],returns:null},{name:"getMenuItems",docblock:null,modifiers:[],params:[{name:"children",type:null}],returns:null},{name:"renderOpener",docblock:null,modifiers:[],params:[{name:"allChildren",type:null}],returns:null}],displayName:"MultiSelect",props:{alignment:{defaultValue:{value:'"left"',computed:!1},required:!1},disabled:{defaultValue:{value:"false",computed:!1},required:!1},light:{defaultValue:{value:"false",computed:!1},required:!1},shortcuts:{defaultValue:{value:"false",computed:!1},required:!1},selectedValues:{defaultValue:{value:"[]",computed:!1},required:!1}}},OptionItem.__docgenInfo={description:"",methods:[{name:"isClassOf",docblock:null,modifiers:["static"],params:[{name:"instance",type:null}],returns:null},{name:"getCheckComponent",docblock:null,modifiers:[],params:[],returns:null}],displayName:"OptionItem",props:{disabled:{defaultValue:{value:"false",computed:!1},required:!1},onToggle:{defaultValue:{value:"() => void 0",computed:!1},required:!1},role:{defaultValue:{value:'"option"',computed:!1},required:!1},selected:{defaultValue:{value:"false",computed:!1},required:!1}}},SeparatorItem.__docgenInfo={description:"",methods:[{name:"isClassOf",docblock:null,modifiers:["static"],params:[{name:"instance",type:null}],returns:null}],displayName:"SeparatorItem"},SingleSelect.__docgenInfo={description:"",methods:[{name:"filterChildren",docblock:null,modifiers:[],params:[{name:"children",type:null}],returns:null},{name:"getMenuItems",docblock:null,modifiers:[],params:[{name:"children",type:null}],returns:null},{name:"renderOpener",docblock:null,modifiers:[],params:[{name:"numItems",type:null}],returns:null}],displayName:"SingleSelect",props:{alignment:{defaultValue:{value:'"left"',computed:!1},required:!1},autoFocus:{defaultValue:{value:"true",computed:!1},required:!1},disabled:{defaultValue:{value:"false",computed:!1},required:!1},enableTypeAhead:{defaultValue:{value:"true",computed:!1},required:!1},light:{defaultValue:{value:"false",computed:!1},required:!1},labels:{defaultValue:{value:"{\n  clearSearch: defaultLabels.clearSearch,\n  filter: defaultLabels.filter,\n  noResults: defaultLabels.noResults,\n  someResults: defaultLabels.someSelected\n}",computed:!1},required:!1}}}},"./packages/wonder-blocks-search-field/dist/es/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>SearchField});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),aphrodite__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/aphrodite/lib/index.js"),_khanacademy_wonder_blocks_typography__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/wonder-blocks-typography/dist/es/index.js"),_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/wonder-blocks-core/dist/es/index.js"),_khanacademy_wonder_blocks_icon_button__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/wonder-blocks-icon-button/dist/es/index.js"),_khanacademy_wonder_blocks_form__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/wonder-blocks-form/dist/es/index.js"),_khanacademy_wonder_blocks_icon__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./packages/wonder-blocks-icon/dist/es/index.js"),_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./packages/wonder-blocks-color/dist/es/index.js"),_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./packages/wonder-blocks-spacing/dist/es/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}const defaultLabels={clearSearch:"Clear search"},_excluded=["clearAriaLabel","autoFocus","disabled","light","id","value","placeholder","style","testId","onClick","onChange","onFocus","onBlur"],SearchField=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((function SearchField(props,ref){const{clearAriaLabel=defaultLabels.clearSearch,autoFocus,disabled=!1,light=!1,id,value,placeholder,style,testId,onClick,onChange,onFocus,onBlur}=props,otherProps=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(props,_excluded),innerRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(null),handleClear=()=>{var _innerRef$current;onChange(""),null==innerRef||null==(_innerRef$current=innerRef.current)||_innerRef$current.focus()};return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_3__.Uj,{id,scope:"search-field"},(uniqueId=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_3__.G7,{onClick,style:[styles.inputContainer,style]},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_icon__WEBPACK_IMPORTED_MODULE_6__.Z,{icon:_khanacademy_wonder_blocks_icon__WEBPACK_IMPORTED_MODULE_6__.c.search,size:"medium",color:_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_7__.default.offBlack64,style:styles.searchIcon,"aria-hidden":"true"}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_form__WEBPACK_IMPORTED_MODULE_5__.nv,_extends({id:`${uniqueId}-field`,type:"text",autoFocus,disabled,light,onChange,onFocus,onBlur,placeholder,ref:node=>{ref&&(ref.current=node),innerRef.current=node},value,style:[styles.inputStyleReset,_khanacademy_wonder_blocks_typography__WEBPACK_IMPORTED_MODULE_2__.W2.LabelMedium],testId},otherProps)),value.length?react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_icon_button__WEBPACK_IMPORTED_MODULE_4__.Z,{icon:_khanacademy_wonder_blocks_icon__WEBPACK_IMPORTED_MODULE_6__.c.dismiss,kind:"tertiary",onClick:handleClear,style:styles.dismissIcon,"aria-label":clearAriaLabel}):null)))})),styles=aphrodite__WEBPACK_IMPORTED_MODULE_1__.StyleSheet.create({inputContainer:{boxSizing:"border-box",flexDirection:"row",borderRadius:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_8__.Z.xxxSmall_4,alignItems:"center",height:40},searchIcon:{marginLeft:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_8__.Z.xSmall_8,marginRight:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_8__.Z.xSmall_8,position:"absolute"},dismissIcon:{margin:0,position:"absolute",right:0,":hover":{border:"none"}},inputStyleReset:{display:"flex",flex:1,"::placeholder":{color:_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_7__.default.offBlack64},width:"100%",color:"inherit",paddingLeft:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_8__.Z.large_24+_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_8__.Z.medium_16,paddingRight:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_8__.Z.large_24+_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_8__.Z.medium_16}});SearchField.__docgenInfo={description:"",methods:[],displayName:"SearchField"}}}]);