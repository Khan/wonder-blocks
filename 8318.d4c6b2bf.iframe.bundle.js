"use strict";(self.webpackChunkwonder_blocks=self.webpackChunkwonder_blocks||[]).push([[8318],{"./packages/wonder-blocks-popover/dist/es/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{J2:()=>Popover,wV:()=>PopoverContentCore,yk:()=>PopoverContent});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_dom__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-dom/index.js"),_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/wonder-blocks-core/dist/es/index.js"),_khanacademy_wonder_blocks_tooltip__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/wonder-blocks-tooltip/dist/es/index.js"),_khanacademy_wonder_blocks_modal__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/wonder-blocks-modal/dist/es/index.js"),aphrodite__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/aphrodite/lib/index.js"),_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./packages/wonder-blocks-spacing/dist/es/index.js"),_khanacademy_wonder_blocks_typography__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./packages/wonder-blocks-typography/dist/es/index.js"),_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./packages/wonder-blocks-color/dist/es/index.js"),_khanacademy_wonder_blocks_icon__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./packages/wonder-blocks-icon/dist/es/index.js"),_khanacademy_wonder_blocks_icon_button__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./packages/wonder-blocks-icon-button/dist/es/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}const defaultContext={close:void 0,placement:"top"},PopoverContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext(defaultContext);PopoverContext.displayName="PopoverContext";class PopoverAnchor extends react__WEBPACK_IMPORTED_MODULE_0__.Component{componentDidMount(){const anchorNode=react_dom__WEBPACK_IMPORTED_MODULE_1__.findDOMNode(this);anchorNode&&this.props.anchorRef(anchorNode)}render(){const{children,id,onClick,"aria-controls":ariaControls,"aria-expanded":ariaExpanded}=this.props,sharedProps={id,"aria-controls":ariaControls,"aria-expanded":ariaExpanded};if("function"==typeof children){const renderedChildren=children({open:onClick});return react__WEBPACK_IMPORTED_MODULE_0__.cloneElement(renderedChildren,sharedProps)}return react__WEBPACK_IMPORTED_MODULE_0__.cloneElement(children,_extends({},children.props,sharedProps,{onClick:children.props.onClick?e=>{e.stopPropagation(),children.props.onClick(),onClick()}:onClick}))}}PopoverAnchor.displayName="PopoverAnchor";class PopoverDialog extends react__WEBPACK_IMPORTED_MODULE_0__.Component{componentDidUpdate(prevProps){prevProps.placement!==this.props.placement&&this.props.onUpdate(this.props.placement)}render(){const{placement,children,id,isReferenceHidden,updateBubbleRef,updateTailRef,tailOffset,style,showTail,"aria-describedby":ariaDescribedby}=this.props,contentProps=children.props,color=contentProps.emphasized?"blue":contentProps.color;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_2__.G7,{"aria-describedby":ariaDescribedby,id,role:"dialog",ref:updateBubbleRef,"data-placement":placement,style:[isReferenceHidden&&styles$2.hide,styles$2[`content-${placement}`],style]},children,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_tooltip__WEBPACK_IMPORTED_MODULE_3__.MR,{show:showTail,color,updateRef:updateTailRef,placement,offset:tailOffset})))}}PopoverDialog.displayName="PopoverDialog";const styles$2=aphrodite__WEBPACK_IMPORTED_MODULE_5__.StyleSheet.create({hide:{pointerEvents:"none",opacity:0,backgroundColor:"transparent",color:"transparent"},"content-top":{flexDirection:"column"},"content-right":{flexDirection:"row-reverse"},"content-bottom":{flexDirection:"column-reverse"},"content-left":{flexDirection:"row"}});function findFocusableNodes(root){return Array.from(root.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'))}class InitialFocus extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(...args){super(...args),this.setInitialFocusableElement=node=>{const firstFocusableElement=this.maybeGetInitialFocusElement(node)||this.maybeGetFirstFocusableElement(node)||node;firstFocusableElement===node&&(node.tabIndex=-1),setTimeout((()=>{firstFocusableElement.focus()}),0)}}componentDidMount(){const node=react_dom__WEBPACK_IMPORTED_MODULE_1__.findDOMNode(this);node&&this.setInitialFocusableElement(node)}maybeGetInitialFocusElement(node){const{initialFocusId}=this.props;return initialFocusId?node.querySelector(`#${initialFocusId}`):null}maybeGetFirstFocusableElement(node){const focusableElements=findFocusableNodes(node);return focusableElements.length?focusableElements[0]:null}render(){return this.props.children}}InitialFocus.displayName="InitialFocus";class FocusManager extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(...args){super(...args),this.nextElementAfterPopover=void 0,this.rootNode=void 0,this.focusableElementsInPopover=[],this.addEventListeners=()=>{const{anchorElement}=this.props;anchorElement&&anchorElement.addEventListener("keydown",this.handleKeydownPreviousFocusableElement,!0),this.nextElementAfterPopover=this.getNextFocusableElement(),this.nextElementAfterPopover&&this.nextElementAfterPopover.addEventListener("keydown",this.handleKeydownNextFocusableElement,!0)},this.getNextFocusableElement=()=>{const{anchorElement}=this.props;if(!anchorElement)return;const focusableElements=findFocusableNodes(document),anchorIndex=focusableElements.indexOf(anchorElement);if(anchorIndex>=0){return focusableElements[anchorIndex<focusableElements.length-1?anchorIndex+1:0]}},this.getComponentRootNode=node=>{if(!node)return;const rootNode=react_dom__WEBPACK_IMPORTED_MODULE_1__.findDOMNode(node);if(!rootNode)throw new Error("Assertion error: root node should exist after mount");this.rootNode=rootNode,this.focusableElementsInPopover=findFocusableNodes(this.rootNode)},this.handleFocusPreviousFocusableElement=()=>{this.props.anchorElement&&this.props.anchorElement.focus()},this.handleFocusNextFocusableElement=()=>{this.nextElementAfterPopover&&this.nextElementAfterPopover.focus()},this.handleKeydownPreviousFocusableElement=e=>{"Tab"!==e.key||e.shiftKey||(e.preventDefault(),this.focusableElementsInPopover[0].focus())},this.handleKeydownNextFocusableElement=e=>{if("Tab"===e.key&&e.shiftKey){e.preventDefault();const lastElementIndex=this.focusableElementsInPopover.length-1;this.focusableElementsInPopover[lastElementIndex].focus()}}}componentDidMount(){this.addEventListeners()}componentDidUpdate(){this.addEventListeners()}componentWillUnmount(){const{anchorElement}=this.props;anchorElement&&(setTimeout((()=>anchorElement.focus()),0),anchorElement.removeEventListener("keydown",this.handleKeydownPreviousFocusableElement,!0)),this.nextElementAfterPopover&&this.nextElementAfterPopover.removeEventListener("keydown",this.handleKeydownNextFocusableElement,!0)}render(){const{children}=this.props;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{tabIndex:0,onFocus:this.handleFocusPreviousFocusableElement,style:{position:"fixed"}}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{ref:this.getComponentRootNode},react__WEBPACK_IMPORTED_MODULE_0__.createElement(InitialFocus,{initialFocusId:this.props.initialFocusId},children)),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{tabIndex:0,onFocus:this.handleFocusNextFocusableElement,style:{position:"fixed"}}))}}FocusManager.displayName="FocusManager";class PopoverEventListener extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(...args){super(...args),this.state={isFirstClick:!0},this._handleKeyup=e=>{"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),this.props.onClose())},this._handleClick=e=>{var _this$props$contentRe;if(this.state.isFirstClick)return void this.setState({isFirstClick:!1});const node=react_dom__WEBPACK_IMPORTED_MODULE_1__.findDOMNode(null==(_this$props$contentRe=this.props.contentRef)?void 0:_this$props$contentRe.current);node&&!node.contains(e.target)&&(e.preventDefault(),e.stopPropagation(),this.props.onClose())}}componentDidMount(){window.addEventListener("keyup",this._handleKeyup),window.addEventListener("click",this._handleClick)}componentWillUnmount(){window.removeEventListener("keyup",this._handleKeyup),window.removeEventListener("click",this._handleClick)}render(){return null}}PopoverEventListener.displayName="PopoverEventListener";class Popover extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(...args){super(...args),this.state={opened:!!this.props.opened,placement:this.props.placement},this.contentRef=react__WEBPACK_IMPORTED_MODULE_0__.createRef(),this.handleClose=()=>{this.setState({opened:!1},(()=>{var _this$props$onClose,_this$props;null==(_this$props$onClose=(_this$props=this.props).onClose)||_this$props$onClose.call(_this$props)}))},this.handleOpen=()=>{this.props.dismissEnabled&&this.state.opened?this.setState({opened:!1}):this.setState({opened:!0})},this.updateRef=actualRef=>{actualRef&&this.state.anchorElement!==actualRef&&this.setState({anchorElement:actualRef})}}static getDerivedStateFromProps(props,state){return{opened:"boolean"==typeof props.opened?props.opened:state.opened}}renderContent(){const{content}=this.props,popoverContents="function"==typeof content?content({close:this.handleClose}):content;return react__WEBPACK_IMPORTED_MODULE_0__.cloneElement(popoverContents,{ref:this.contentRef})}renderPopper(uniqueId){const{initialFocusId,placement,showTail}=this.props,{anchorElement}=this.state;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(FocusManager,{anchorElement,initialFocusId},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_tooltip__WEBPACK_IMPORTED_MODULE_3__.nt,{anchorElement,placement},(props=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(PopoverDialog,_extends({},props,{"aria-describedby":`${uniqueId}-anchor`,id:uniqueId,onUpdate:placement=>this.setState({placement}),showTail}),this.renderContent()))))}getHost(){return(0,_khanacademy_wonder_blocks_modal__WEBPACK_IMPORTED_MODULE_4__.jq)(this.state.anchorElement)||document.body}render(){const{children,dismissEnabled,id}=this.props,{opened,placement}=this.state,popperHost=this.getHost();return react__WEBPACK_IMPORTED_MODULE_0__.createElement(PopoverContext.Provider,{value:{close:this.handleClose,placement}},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_2__.Uj,{id,scope:"popover"},(uniqueId=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(PopoverAnchor,{anchorRef:this.updateRef,id:`${uniqueId}-anchor`,"aria-controls":uniqueId,"aria-expanded":opened?"true":"false",onClick:this.handleOpen},children),popperHost&&opened&&react_dom__WEBPACK_IMPORTED_MODULE_1__.createPortal(this.renderPopper(uniqueId),popperHost)))),dismissEnabled&&opened&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(PopoverEventListener,{onClose:this.handleClose,contentRef:this.contentRef}))}}Popover.displayName="Popover",Popover.defaultProps={placement:"top",showTail:!0};class CloseButton extends react__WEBPACK_IMPORTED_MODULE_0__.Component{render(){const{light,"aria-label":ariaLabel,style,testId}=this.props;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(PopoverContext.Consumer,null,(({close})=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_icon_button__WEBPACK_IMPORTED_MODULE_10__.Z,{icon:_khanacademy_wonder_blocks_icon__WEBPACK_IMPORTED_MODULE_9__.c.dismiss,"aria-label":ariaLabel,onClick:close,kind:light?"primary":"tertiary",light,style,testId})))}}CloseButton.displayName="CloseButton",CloseButton.defaultProps={light:!0,"aria-label":"Close Popover"};class PopoverContentCore extends react__WEBPACK_IMPORTED_MODULE_0__.Component{render(){const{children,closeButtonLight,closeButtonLabel,closeButtonVisible,color,style,testId}=this.props;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_2__.G7,{testId,style:[styles$1.content,"white"!==color&&styles$1[color],style]},closeButtonVisible&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(CloseButton,{"aria-label":closeButtonLabel,light:closeButtonLight||"white"!==color,style:styles$1.closeButton,testId:`${testId||"popover"}-close-btn`}),children)}}PopoverContentCore.displayName="PopoverContentCore",PopoverContentCore.defaultProps={color:"white",closeButtonLight:!1,closeButtonVisible:!1};const styles$1=aphrodite__WEBPACK_IMPORTED_MODULE_5__.StyleSheet.create({content:{borderRadius:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.xxxSmall_4,border:`solid 1px ${_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_8__.default.offBlack16}`,backgroundColor:_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_8__.default.white,boxShadow:`0 ${_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.xSmall_8}px ${_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.xSmall_8}px 0 ${_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_8__.default.offBlack8}`,margin:0,maxWidth:18*_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.medium_16,padding:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.large_24,overflow:"hidden",justifyContent:"center"},blue:{backgroundColor:_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_8__.default.blue,color:_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_8__.default.white},darkBlue:{backgroundColor:_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_8__.default.darkBlue,color:_khanacademy_wonder_blocks_color__WEBPACK_IMPORTED_MODULE_8__.default.white},closeButton:{position:"absolute",right:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.xSmall_8,top:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.xSmall_8,zIndex:1}}),StyledImage=(0,_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_2__.cu)("img");class PopoverContent extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(...args){super(...args),this.maybeRenderImage=({placement})=>{const{image}=this.props;return image?react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_2__.G7,{style:[styles.image,"bottom"===placement&&styles.imageToBottom]},image):null},this.maybeRenderIcon=()=>{const{icon}=this.props;return icon?react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_2__.G7,{style:styles.iconContainer},"string"!=typeof icon?icon:react__WEBPACK_IMPORTED_MODULE_0__.createElement(StyledImage,{src:icon,style:styles.icon})):null},this.maybeRenderActions=close=>{const{actions}=this.props;return actions?react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_2__.G7,{style:styles.actions},"function"==typeof actions?actions({close}):actions):null}}componentDidMount(){const{icon,image}=this.props;if(image&&icon)throw new Error("'image' and 'icon' cannot be used at the same time. You can fix this by either removing 'image' or 'icon' from your instance.")}validateProps({placement}){if(this.props.image&&("left"===placement||"right"===placement))throw new Error("'image' can only be vertically placed. You can fix this by either changing `placement` to `top` or `bottom` or removing the `image` prop inside `content`.")}render(){const{closeButtonLabel,closeButtonVisible,content,emphasized,icon,image,style,title,testId}=this.props;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(PopoverContext.Consumer,null,(({close,placement})=>(this.validateProps({close,placement}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(PopoverContentCore,{color:emphasized?"blue":"white",closeButtonLight:image&&"top"===placement,closeButtonLabel,closeButtonVisible,style,testId},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_2__.G7,{style:!!icon&&styles.withIcon},this.maybeRenderImage({placement}),this.maybeRenderIcon(),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_core__WEBPACK_IMPORTED_MODULE_2__.G7,{style:styles.text},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_typography__WEBPACK_IMPORTED_MODULE_7__.Jf,{style:styles.title},title),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_khanacademy_wonder_blocks_typography__WEBPACK_IMPORTED_MODULE_7__.uT,null,content))),this.maybeRenderActions(close)))))}}PopoverContent.displayName="PopoverContent",PopoverContent.defaultProps={closeButtonVisible:!1};const styles=aphrodite__WEBPACK_IMPORTED_MODULE_5__.StyleSheet.create({actions:{marginTop:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.large_24,flexDirection:"row",alignItems:"center",justifyContent:"flex-end"},text:{justifyContent:"center"},title:{marginBottom:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.xSmall_8},iconContainer:{alignItems:"center",justifyContent:"center",height:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.xxxLarge_64,width:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.xxxLarge_64,minWidth:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.xxxLarge_64,marginRight:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.medium_16,overflow:"hidden"},icon:{width:"100%"},withIcon:{flexDirection:"row"},image:{marginBottom:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.large_24,marginLeft:-_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.large_24,marginRight:-_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.large_24,marginTop:-_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.large_24,width:`calc(100% + ${2*_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.large_24}px)`},imageToBottom:{marginBottom:-_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.large_24,marginTop:_khanacademy_wonder_blocks_spacing__WEBPACK_IMPORTED_MODULE_6__.Z.large_24,order:1}});Popover.__docgenInfo={description:"",methods:[{name:"renderContent",docblock:null,modifiers:[],params:[],returns:null},{name:"renderPopper",docblock:null,modifiers:[],params:[{name:"uniqueId",type:null}],returns:null},{name:"getHost",docblock:null,modifiers:[],params:[],returns:null}],displayName:"Popover",props:{placement:{defaultValue:{value:'"top"',computed:!1},required:!1},showTail:{defaultValue:{value:"true",computed:!1},required:!1}}},PopoverContent.__docgenInfo={description:"",methods:[{name:"validateProps",docblock:null,modifiers:[],params:[{name:"{\n  placement\n}",type:null}],returns:null}],displayName:"PopoverContent",props:{closeButtonVisible:{defaultValue:{value:"false",computed:!1},required:!1}}},PopoverContentCore.__docgenInfo={description:"",methods:[],displayName:"PopoverContentCore",props:{color:{defaultValue:{value:'"white"',computed:!1},required:!1},closeButtonLight:{defaultValue:{value:"false",computed:!1},required:!1},closeButtonVisible:{defaultValue:{value:"false",computed:!1},required:!1}}}},"./packages/wonder-blocks-popover/package.json":module=>{module.exports=JSON.parse('{"u2":"@khanacademy/wonder-blocks-popover","i8":"2.1.4"}')}}]);