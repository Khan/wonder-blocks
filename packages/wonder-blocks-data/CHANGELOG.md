# @khanacademy/wonder-blocks-data

## 13.0.0

### Major Changes

-   65c02cff: Return new no-data state from useCachedEffect when it is not loading and there is no data to return

### Patch Changes

-   Updated dependencies [1920feb8]
    -   @khanacademy/wonder-blocks-core@6.0.1

## 12.0.0

### Major Changes

-   674a1e5c: POJOs have been replace with TS enums

### Patch Changes

-   674a1e5c: We're no longer building flow types
-   Updated dependencies [674a1e5c]
-   Updated dependencies [674a1e5c]
    -   @khanacademy/wonder-blocks-core@6.0.0

## 11.0.16

### Patch Changes

-   Updated dependencies [1344436f]
    -   @khanacademy/wonder-blocks-core@5.4.0

## 11.0.15

### Patch Changes

-   Updated dependencies [9f3752d4]
    -   @khanacademy/wonder-blocks-core@5.3.1

## 11.0.14

### Patch Changes

-   Updated dependencies [c37b99aa]
-   Updated dependencies [c4cef3e6]
    -   @khanacademy/wonder-blocks-core@5.3.0

## 11.0.13

### Patch Changes

-   Updated dependencies [d4c412b5]
    -   @khanacademy/wonder-blocks-core@5.2.3

## 11.0.12

### Patch Changes

-   Updated dependencies [64a188e3]
    -   @khanacademy/wonder-blocks-core@5.2.2

## 11.0.11

### Patch Changes

-   5a1ea891: Make sure that React contexts are named
-   Updated dependencies [5a1ea891]
-   Updated dependencies [df9a10aa]
    -   @khanacademy/wonder-blocks-core@5.2.1

## 11.0.10

### Patch Changes

-   Updated dependencies [fa70c895]
-   Updated dependencies [19ab0408]
-   Updated dependencies [fa70c895]
    -   @khanacademy/wonder-blocks-core@5.2.0

## 11.0.9

### Patch Changes

-   a6164ed0: Don't use React.FC<> for functional components
-   Updated dependencies [3c400719]
-   Updated dependencies [a6164ed0]
    -   @khanacademy/wonder-blocks-core@5.1.0

## 11.0.8

## 11.0.7

## 11.0.6

### Patch Changes

-   c20f48f3: Don't transpile classes when building bundles
-   Updated dependencies [c20f48f3]
    -   @khanacademy/wonder-blocks-core@5.0.4

## 11.0.5

### Patch Changes

-   43155769: Fix DocumentNode type definition

## 11.0.4

### Patch Changes

-   bedcbcf8: Update <Data>'s 'children' prop to allow a ReactNode to be returned

## 11.0.3

### Patch Changes

-   Updated dependencies [b281e2eb]
    -   @khanacademy/wonder-blocks-core@5.0.3

## 11.0.2

### Patch Changes

-   Updated dependencies [21ce20c7]
    -   @khanacademy/wonder-blocks-core@5.0.2

## 11.0.1

### Patch Changes

-   ccb6fe00: Miscellaneous TS type fixes
-   d4c2b18c: Fix a variety of issues with Flow types generated by flowgen
-   Updated dependencies [ccb6fe00]
-   Updated dependencies [d4c2b18c]
    -   @khanacademy/wonder-blocks-core@5.0.1

## 11.0.0

### Major Changes

-   1ca4d7e3: Fix minor issue with generate Flow types (this is a major bump b/c I forgot to do one after doing the TS conversion)

### Patch Changes

-   Updated dependencies [1ca4d7e3]
    -   @khanacademy/wonder-blocks-core@5.0.0

## 10.1.3

### Patch Changes

-   b5ba5568: Ensure that flow lib defs use React.ElementConfig<> isntead of JSX.LibraryManagedAttributes<>
-   Updated dependencies [b5ba5568]
    -   @khanacademy/wonder-blocks-core@4.9.1

## 10.1.2

### Patch Changes

-   Updated dependencies [779b031d]
    -   @khanacademy/wonder-blocks-core@4.9.0

## 10.1.1

### Patch Changes

-   d816af08: Update build and test configs use TypeScript
-   3891f544: Update babel config to include plugins that Storybook needed
-   3813715d: Update wonder-stuff dependencies (non-functional changes)
-   0d28bb1c: Configured TypeScript
-   3d05f764: Fix HOCs and other type errors
-   c2ec4902: Update eslint configuration, fix lint
-   2983c05b: Include 'types' field in package.json
-   77ff6a66: Generate Flow types from TypeScript types
-   ec8d4b7f: Fix miscellaneous TypeScript errors
-   Updated dependencies [d816af08]
-   Updated dependencies [3891f544]
-   Updated dependencies [0d28bb1c]
-   Updated dependencies [873f4a14]
-   Updated dependencies [3d05f764]
-   Updated dependencies [c2ec4902]
-   Updated dependencies [2983c05b]
-   Updated dependencies [77ff6a66]
-   Updated dependencies [ec8d4b7f]
    -   @khanacademy/wonder-blocks-core@4.8.0

## 10.1.0

### Minor Changes

-   91cb727c: Convert enums to POJOs

### Patch Changes

-   91cb727c: Update wonder-stuff dependencies
-   91cb727c: Remove file extensions from imports
-   Updated dependencies [91cb727c]
-   Updated dependencies [91cb727c]
    -   @khanacademy/wonder-blocks-core@4.7.0

## 10.0.5

### Patch Changes

-   1a5624d4: Update wonder-stuff dependencies to use newly published packages after migrating wonder-stuff to TypeScript

## 10.0.4

### Patch Changes

-   Updated dependencies [496119f2]
    -   @khanacademy/wonder-blocks-core@4.6.2

## 10.0.3

### Patch Changes

-   @khanacademy/wonder-blocks-core@4.6.1

## 10.0.2

### Patch Changes

-   Updated dependencies [b561425a]
-   Updated dependencies [a566e232]
-   Updated dependencies [d2b21a6e]
    -   @khanacademy/wonder-blocks-core@4.6.0

## 10.0.1

### Patch Changes

-   Updated dependencies [175a2dd2]
    -   @khanacademy/wonder-blocks-core@4.5.0

## 10.0.0

### Major Changes

-   5a3ec7f9: Make sure request ID generation handles objects like Date and Error instances better

## 9.1.2

### Patch Changes

-   Updated dependencies [6ee20af9]
    -   @khanacademy/wonder-blocks-core@4.4.0

## 9.1.1

### Patch Changes

-   eb59ce34: Update to latest Wonder Stuff Core

## 9.1.0

### Minor Changes

-   944c3071: Make sure objects and arrays in variables are sorted and readable in generated request identifiers

## 9.0.0

### Major Changes

-   778f8e43: `SharedCache` export added for interacting with the shared in-memory cache. `purgeSharedCache` method has been removed.
-   778f8e43: Rename `ScopedCache` type to `RawScopedCache`

## 8.0.5

### Patch Changes

-   08238b89: Export the `getGqlDataFromResponse` method so we can use it in custom `gqlFetch` scenarios for a consistent experience

## 8.0.4

### Patch Changes

-   dc2e00f4: Do not fetch if FetchPolicy is CacheBeforeNetwork and there is already a cached value, even if the requestId changes

## 8.0.3

### Patch Changes

-   5f4a4297: Make dependency on `flow-enums-runtime` explicit
-   2b96fd59: Change flow-enums-runtime to be peer dependencies
-   Updated dependencies [5f4a4297]
-   Updated dependencies [2b96fd59]
    -   @khanacademy/wonder-blocks-core@4.3.2

## 8.0.2

### Patch Changes

-   580141ed: Always initialize SSR-only cache

## 8.0.1

### Patch Changes

-   e5fa4d9e: Make sure ssr-only cache is initialized when purging caches in test environment

## 8.0.0

### Major Changes

-   0720470e: Renamed `initializeCache` to `initializeHydrationCache`, deleted `removeFromCache`, renamed `removeAllFromCache` to `purgeHydrationCache`
-   cf9ed87f: Add `fetchPolicy` to `useCachedEffect` options, add `refetch` to `useCachedEffect` return value (return value is now a tuple of [result, refetch]), add abort API to request fulfillment (not truly aborting though)
-   b882b082: Stop exporting `RequestFulfillment`, update `useCachedEffect` to consider scope with sharing inflight requests
-   0720470e: Rename `fulfillAllDataRequests` to `fetchTrackedRequests`, rename `hasUnfulfilledRequests` to `hasTrackedRequestsToBeFetched`
-   0720470e: Renamed `clearSharedCache` to `purgeSharedCache`

### Minor Changes

-   0720470e: Add `purgeCaches` export for purging all caches with one call
-   75c10036: Add `abortInflightRequests` to exports
-   a85f2f3a: Provide `getGqlRequestId` function

### Patch Changes

-   1385f468: Removed unnecessary `new` on tracking context creation

## 7.0.1

### Patch Changes

-   @khanacademy/wonder-blocks-core@4.3.1

## 7.0.0

### Major Changes

-   34407c4a: `useServerEffect` now has a `skip` option, preventing the request from getting tracked for server-side fulfillment

## 6.0.1

### Patch Changes

-   5ad01891: [FIX] Make sure hydratable effect properly renders when requestId changes

## 6.0.0

### Major Changes

-   1f34c4e8: `Result<TData>` is now the main return type, `useGql` supports context modification, and context overrides that are set explicitly to null now mean those values are deleted when merging
-   885fe62b: [NEW] `useCachedEffect` hook for performing asynchronous work client-side and caching the result. Updated `useHydratableEffect` to use `useCachedEffect`. `useServerEffect` handler is now interceptable with Wonder Blocks Data `InterceptData` component.
-   5c852025: [NEW] Added the `useHydratableEffect` hook and updated the `Data` component to use it. Breaking change: `Data` props have been renamed and retyped to fit `useHydratableResult` API.
-   c91f3959: New `DataError` type and changes to the `GqlError` type. Also changes what errors are thrown in various code
-   753220a4: Exported in-flight request tracking mechanism and reworked Data component so that client-side requests don't get morphed to and from a cache-style value

### Minor Changes

-   5d614ed4: Changed `Result<TData>` error status so that error field is an error object, not a string

### Patch Changes

-   Updated dependencies [246a921d]
    -   @khanacademy/wonder-blocks-core@4.3.0

## 5.0.1

### Patch Changes

-   c9922b34: Export resultFromCachedResponse

## 5.0.0

### Major Changes

-   5b5f85ac: Replace `InterceptData` with `InterceptRequests` and introduce new `useRequestInterception` hook

## 4.0.0

### Major Changes

-   febc7309: Rename types and update signatures
    -   `ValidData` is now `ValidCacheData`
    -   `Cache` type is now `ResponseCache` (old `ResponseCache` can be created with `$ReadOnly<ResponseCache>`)
    -   `CacheEntry` type is now `CachedResponse`
    -   Signatures that were typed as `$ReadOnly<Cache>` previously are now typed as `ResponseCache` which is more appropriate to how they work
-   bffc345e: Simplified, more versatile API

    -   NEW: `useServerEffect` hook - a way to perform asynchronous tasks on the server and have the value available for hydration
    -   UPDATED: `Data` component - New API that does away with the `IRequestHandler` interface. Includes new props to control behavior on hydration and when new requests occur.
    -   UPDATED: `InterceptData` component - New API to reflect changes in `Data` component.

    -   REMOVED: `IRequestHandler` API. All associated call signatures have been updated to reflect this.
    -   REMOVED: `useData` hook - The `Data` component should be used

### Minor Changes

-   7c9dd09b: - New `useSharedData` hook
    -   New `ScopedInMemoryCache` export

## 3.2.0

### Minor Changes

-   6973afa2: useGql method now merges defaultContext and partial context by ignoring values explicitly set to undefined in the partial context. This ensures that that existing default context values are not overridden unless explicitly given a value other than undefined.

## 3.1.3

### Patch Changes

-   9931ae6b: Simplify GQL types

## 3.1.2

### Patch Changes

-   @khanacademy/wonder-blocks-core@4.2.1

## 3.1.1

### Patch Changes

-   4ff59815: Add GraphQL fetch mock support to wonder-blocks-testing

## 3.1.0

### Minor Changes

-   b68cedfe: Add GqlRouter component
-   c7233a97: Implement useGql hook

## 3.0.1

### Patch Changes

-   d281dac8: Ensure server-side request fulfillments can be intercepted

## 3.0.0

### Major Changes

-   b252d9c8: Remove client-side caching
-   b252d9c8: Introduce useData hook
