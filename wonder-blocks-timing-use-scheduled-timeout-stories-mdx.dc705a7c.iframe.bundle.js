/*! For license information please see wonder-blocks-timing-use-scheduled-timeout-stories-mdx.dc705a7c.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkwonder_blocks=self.webpackChunkwonder_blocks||[]).push([[6126],{"./node_modules/@mdx-js/react/lib/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{NF:()=>withMDXComponents,Zo:()=>MDXProvider,ah:()=>useMDXComponents,pC:()=>MDXContext});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");const MDXContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext({});function withMDXComponents(Component){return function boundMDXComponent(props){const allComponents=useMDXComponents(props.components);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(Component,{...props,allComponents})}}function useMDXComponents(components){const contextComponents=react__WEBPACK_IMPORTED_MODULE_0__.useContext(MDXContext);return react__WEBPACK_IMPORTED_MODULE_0__.useMemo((()=>"function"==typeof components?components(contextComponents):{...contextComponents,...components}),[contextComponents,components])}const emptyObject={};function MDXProvider({components,children,disableParentContext}){let allComponents;return allComponents=disableParentContext?"function"==typeof components?components({}):components||emptyObject:useMDXComponents(components),react__WEBPACK_IMPORTED_MODULE_0__.createElement(MDXContext.Provider,{value:allComponents},children)}},"./packages/wonder-blocks-timing/dist/es/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$K:()=>withActionScheduler,KS:()=>useTimeout,Tt:()=>ClearPolicy,Yz:()=>useInterval,cy:()=>useScheduledTimeout,fk:()=>SchedulePolicy,kb:()=>useScheduledInterval});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");const SchedulePolicy={Immediately:"schedule-immediately",OnDemand:"schedule-on-demand"},ClearPolicy={Resolve:"resolve-on-clear",Cancel:"cancel-on-clear"};class Timeout{constructor(action,timeoutMs,schedulePolicy=SchedulePolicy.Immediately){if(this._timeoutId=void 0,this._action=void 0,this._timeoutMs=void 0,"function"!=typeof action)throw new Error("Action must be a function");if(timeoutMs<0)throw new Error("Timeout period must be >= 0");this._action=action,this._timeoutMs=timeoutMs,schedulePolicy===SchedulePolicy.Immediately&&this.set()}get isSet(){return null!=this._timeoutId}set(){this.isSet&&this.clear(ClearPolicy.Cancel),this._timeoutId=setTimeout((()=>this.clear(ClearPolicy.Resolve)),this._timeoutMs)}clear(policy=ClearPolicy.Cancel){const timeoutId=this._timeoutId;this._timeoutId=null,null!=timeoutId&&(clearTimeout(timeoutId),policy===ClearPolicy.Resolve&&this._action())}}class Interval{constructor(action,intervalMs,schedulePolicy=SchedulePolicy.Immediately){if(this._intervalId=void 0,this._action=void 0,this._intervalMs=void 0,"function"!=typeof action)throw new Error("Action must be a function");if(intervalMs<1)throw new Error("Interval period must be >= 1");this._action=action,this._intervalMs=intervalMs,schedulePolicy===SchedulePolicy.Immediately&&this.set()}get isSet(){return null!=this._intervalId}set(){this.isSet&&this.clear(ClearPolicy.Cancel),this._intervalId=setInterval((()=>this._action()),this._intervalMs)}clear(policy=ClearPolicy.Cancel){const intervalId=this._intervalId;this._intervalId=null,null!=intervalId&&(clearInterval(intervalId),policy===ClearPolicy.Resolve&&this._action())}}class AnimationFrame{constructor(action,schedulePolicy=SchedulePolicy.Immediately){if(this._animationFrameId=void 0,this._action=void 0,"function"!=typeof action)throw new Error("Action must be a function");this._action=action,schedulePolicy===SchedulePolicy.Immediately&&this.set()}get isSet(){return null!=this._animationFrameId}set(){this.isSet&&this.clear(ClearPolicy.Cancel),this._animationFrameId=requestAnimationFrame((time=>this.clear(ClearPolicy.Resolve,time)))}clear(policy=ClearPolicy.Cancel,time){const animationFrameId=this._animationFrameId;this._animationFrameId=null,null!=animationFrameId&&(cancelAnimationFrame(animationFrameId),policy===ClearPolicy.Resolve&&this._action(time||performance.now()))}}class ActionScheduler{constructor(){this._disabled=!1,this._registeredActions=[]}timeout(action,period,options){if(this._disabled)return ActionScheduler.NoopAction;const timeout=new Timeout(action,period,null==options?void 0:options.schedulePolicy);return this._registeredActions.push((()=>timeout.clear(null==options?void 0:options.clearPolicy))),timeout}interval(action,period,options){if(this._disabled)return ActionScheduler.NoopAction;const interval=new Interval(action,period,null==options?void 0:options.schedulePolicy);return this._registeredActions.push((()=>interval.clear(null==options?void 0:options.clearPolicy))),interval}animationFrame(action,options){if(this._disabled)return ActionScheduler.NoopAction;const animationFrame=new AnimationFrame(action,null==options?void 0:options.schedulePolicy);return this._registeredActions.push((()=>animationFrame.clear(null==options?void 0:options.clearPolicy))),animationFrame}clearAll(){const registered=[...this._registeredActions];this._registeredActions=[],registered.forEach((clearFn=>clearFn()))}disable(){this._disabled=!0,this.clearAll()}}ActionScheduler.NoopAction={set:()=>{},get isSet(){return!1},clear:()=>{}};class ActionSchedulerProvider extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(...args){super(...args),this._actionScheduler=new ActionScheduler}componentWillUnmount(){this._actionScheduler.disable()}render(){const{children}=this.props;return children(this._actionScheduler)}}function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}function withActionScheduler(WrappedComponent){return props=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(ActionSchedulerProvider,null,(schedule=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(WrappedComponent,_extends({},props,{schedule}))))}ActionSchedulerProvider.displayName="ActionSchedulerProvider";const useUpdatingRef=value=>{const ref=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(value);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{ref.current=value}),[value]),ref};function useInterval(action,intervalMs,active){const actionRef=useUpdatingRef(action);(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{if(active){const intervalId=setInterval((()=>{actionRef.current()}),intervalMs);return()=>{clearInterval(intervalId)}}}),[intervalMs,active,actionRef])}function useTimeout(action,timeoutMs,active){const actionRef=useUpdatingRef(action);(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{if(active){const timeoutId=setTimeout((()=>{actionRef.current()}),timeoutMs);return()=>{clearTimeout(timeoutId)}}}),[timeoutMs,active,actionRef])}function useScheduledInterval(action,intervalMs,options){var _options$schedulePoli;if("function"!=typeof action)throw new Error("Action must be a function");if(intervalMs<1)throw new Error("Interval period must be >= 1");const schedulePolicy=null!=(_options$schedulePoli=null==options?void 0:options.schedulePolicy)?_options$schedulePoli:SchedulePolicy.Immediately,[isSet,setIsSet]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(schedulePolicy===SchedulePolicy.Immediately),set=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((()=>setIsSet(!0)),[]),actionRef=useUpdatingRef(action),clear=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((policy=>{var _policy;policy=null!=(_policy=policy)?_policy:null==options?void 0:options.clearPolicy,isSet&&policy===ClearPolicy.Resolve&&actionRef.current(),setIsSet(!1)}),[actionRef,isSet,null==options?void 0:options.clearPolicy]),runOnUnmountRef=useUpdatingRef(isSet&&(null==options?void 0:options.clearPolicy)===ClearPolicy.Resolve);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>()=>{runOnUnmountRef.current&&actionRef.current()}),[]),useInterval(action,intervalMs,isSet),{isSet,set,clear}}function useScheduledTimeout(action,timeoutMs,options){var _options$schedulePoli;if("function"!=typeof action)throw new Error("Action must be a function");if(timeoutMs<0)throw new Error("Timeout period must be >= 0");const schedulePolicy=null!=(_options$schedulePoli=null==options?void 0:options.schedulePolicy)?_options$schedulePoli:SchedulePolicy.Immediately,[isSet,setIsSet]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(schedulePolicy===SchedulePolicy.Immediately),set=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((()=>setIsSet(!0)),[]),wrappedAction=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((()=>{setIsSet(!1),action()}),[action]),actionRef=useUpdatingRef(wrappedAction),clear=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((policy=>{var _policy;policy=null!=(_policy=policy)?_policy:null==options?void 0:options.clearPolicy,isSet&&policy===ClearPolicy.Resolve&&actionRef.current(),setIsSet(!1)}),[actionRef,isSet,null==options?void 0:options.clearPolicy]),runOnUnmountRef=useUpdatingRef(isSet&&(null==options?void 0:options.clearPolicy)===ClearPolicy.Resolve);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>()=>{runOnUnmountRef.current&&actionRef.current()}),[]),useTimeout(wrappedAction,timeoutMs,isSet),{isSet,set,clear}}ActionSchedulerProvider.__docgenInfo={description:"",methods:[],displayName:"ActionSchedulerProvider"}},"./__docs__/wonder-blocks-timing/use-scheduled-timeout.stories.mdx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Immediately:()=>Immediately,OnDemandAndResolveOnClear:()=>OnDemandAndResolveOnClear,default:()=>use_scheduled_timeout_stories,immediately:()=>immediately,onDemandAndResolveOnClear:()=>onDemandAndResolveOnClear});var react=__webpack_require__("./node_modules/react/index.js"),lib=__webpack_require__("./node_modules/@mdx-js/react/lib/index.js"),dist=__webpack_require__("./node_modules/@storybook/blocks/dist/index.mjs"),dist_es=(__webpack_require__("./packages/wonder-blocks-typography/dist/es/index.js"),__webpack_require__("./packages/wonder-blocks-core/dist/es/index.js")),wonder_blocks_button_dist_es=__webpack_require__("./packages/wonder-blocks-button/dist/es/index.js");const SchedulePolicy_OnDemand="schedule-on-demand",ClearPolicy_Resolve="resolve-on-clear";var wonder_blocks_timing_dist_es=__webpack_require__("./packages/wonder-blocks-timing/dist/es/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const Immediately=()=>{const[callCount,setCallCount]=react.useState(0),callback=react.useCallback((()=>{setCallCount((callCount=>callCount+1))}),[]),{isSet,set,clear}=(0,wonder_blocks_timing_dist_es.cy)(callback,1e3);return(0,jsx_runtime.jsxs)(dist_es.G7,{children:[(0,jsx_runtime.jsxs)(dist_es.G7,{children:["isSet = ",isSet.toString()]}),(0,jsx_runtime.jsxs)(dist_es.G7,{children:["callCount = ",callCount]}),(0,jsx_runtime.jsxs)(dist_es.G7,{style:{flexDirection:"row"},children:[(0,jsx_runtime.jsx)(wonder_blocks_button_dist_es.Z,{onClick:set,children:"Set timeout"}),(0,jsx_runtime.jsx)(wonder_blocks_button_dist_es.Z,{onClick:clear,children:"Clear timeout"})]})]})},OnDemandAndResolveOnClear=()=>{const[callCount,setCallCount]=react.useState(0),callback=react.useCallback((()=>{console.log("action called"),setCallCount((callCount=>callCount+1))}),[]),{isSet,set,clear}=(0,wonder_blocks_timing_dist_es.cy)(callback,1e3,{clearPolicy:ClearPolicy_Resolve,schedulePolicy:SchedulePolicy_OnDemand});return(0,jsx_runtime.jsxs)(dist_es.G7,{children:[(0,jsx_runtime.jsxs)(dist_es.G7,{children:["isSet = ",isSet.toString()]}),(0,jsx_runtime.jsxs)(dist_es.G7,{children:["callCount = ",callCount]}),(0,jsx_runtime.jsxs)(dist_es.G7,{style:{flexDirection:"row"},children:[(0,jsx_runtime.jsx)(wonder_blocks_button_dist_es.Z,{onClick:()=>set(),children:"Set timeout"}),(0,jsx_runtime.jsx)(wonder_blocks_button_dist_es.Z,{onClick:()=>clear(),children:"Clear timeout"})]})]})};function _createMdxContent(props){const _components=Object.assign({h1:"h1",code:"code",p:"p",pre:"pre",ul:"ul",li:"li"},(0,lib.ah)(),props.components);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(dist.h_,{title:"Timing/useScheduledTimeout",parameters:{chromatic:{disableSnapshot:!0}}}),"\n",(0,jsx_runtime.jsx)(_components.h1,{id:"usescheduledtimeout",children:(0,jsx_runtime.jsx)(_components.code,{children:"useScheduledTimeout"})}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"useScheduledTimeout"})," is a hook that provides a convenient API for setting and clearing\na timeout. It is defined as follows:"]}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-ts",children:'function useScheduledTimeout(\n    action: () => mixed,\n    timeoutMs: number,\n    options?: {|\n        schedulePolicy?: "schedule-immediately" | "schedule-on-demand",\n        clearPolicy?: "resolve-on-clear" | "cancel-on-clear",\n    |},\n): ITimeout;\n\ninterface ITimeout {\n    get isSet(): boolean;\n    set(): void;\n    clear(policy?: ClearPolicy): void;\n}\n'})}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["By default the timeout will be set immediately up creation. The ",(0,jsx_runtime.jsx)(_components.code,{children:"options"})," parameter can\nbe used to control when when the timeout is schedule and whether or not ",(0,jsx_runtime.jsx)(_components.code,{children:"action"})," should be\ncalled when the timeout is cleared."]}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:"Notes:"}),"\n",(0,jsx_runtime.jsxs)(_components.ul,{children:["\n",(0,jsx_runtime.jsxs)(_components.li,{children:["Because ",(0,jsx_runtime.jsx)(_components.code,{children:"clear"})," takes a param, it's import that you don't pass it directly to an event handler,\ne.g. ",(0,jsx_runtime.jsx)(_components.code,{children:"<Button onClick={clear} />"})," will not work as expected."]}),"\n",(0,jsx_runtime.jsxs)(_components.li,{children:["Calling ",(0,jsx_runtime.jsx)(_components.code,{children:"set"})," after the timeout has expired will restart the timeout."]}),"\n",(0,jsx_runtime.jsxs)(_components.li,{children:["Updating the second paramter, ",(0,jsx_runtime.jsx)(_components.code,{children:"timeoutMs"}),", will also restart the timeout."]}),"\n",(0,jsx_runtime.jsx)(_components.li,{children:"When the component using this hooks is unmounted, the timeout will automatically be cleared."}),"\n",(0,jsx_runtime.jsxs)(_components.li,{children:["Calling ",(0,jsx_runtime.jsx)(_components.code,{children:"set"})," after the timeout is set but before it expires means that the timeout will be\nreset and will call ",(0,jsx_runtime.jsx)(_components.code,{children:"action"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"timeoutMs"})," after the most recent call to ",(0,jsx_runtime.jsx)(_components.code,{children:"set"})," was made."]}),"\n"]}),"\n","\n",(0,jsx_runtime.jsx)(dist.Xz,{children:(0,jsx_runtime.jsx)(dist.oG,{name:"Immediately",children:(0,jsx_runtime.jsx)(Immediately,{})})}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-jsx",children:'const Immediately = () => {\n    const [callCount, setCallCount] = React.useState(0);\n    const callback = React.useCallback(() => {\n        setCallCount((callCount) => callCount + 1);\n    }, []);\n    const {isSet, set, clear} = useScheduledTimeout(callback, 1000);\n    return (\n        <View>\n            <View>isSet = {isSet.toString()}</View>\n            <View>callCount = {callCount}</View>\n            <View style={{flexDirection: "row"}}>\n                <Button onClick={() => set()}>Set timeout</Button>\n                <Button onClick={() => clear()}>Clear timeout</Button>\n            </View>\n        </View>\n    );\n};\n'})}),"\n","\n",(0,jsx_runtime.jsx)(dist.Xz,{children:(0,jsx_runtime.jsx)(dist.oG,{name:"OnDemandAndResolveOnClear",children:(0,jsx_runtime.jsx)(OnDemandAndResolveOnClear,{})})}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-jsx",children:'const OnDemandAndResolveOnClear = () => {\n    const [callCount, setCallCount] = React.useState(0);\n    const callback = React.useCallback(() => {\n        setCallCount((callCount) => callCount + 1);\n    }, []);\n    const {isSet, set, clear} = useScheduledTimeout(callback, 1000, {\n        clearPolicy: ClearPolicy.Resolve,\n        schedulePolicy: SchedulePolicy.OnDemand,\n    });\n    return (\n        <View>\n            <View>isSet = {isSet.toString()}</View>\n            <View>callCount = {callCount}</View>\n            <View style={{flexDirection: "row"}}>\n                <Button onClick={() => set()}>Set timeout</Button>\n                <Button onClick={() => clear()}>Clear timeout</Button>\n            </View>\n        </View>\n    );\n};\n'})})]})}const immediately=()=>(0,jsx_runtime.jsx)(Immediately,{});immediately.storyName="Immediately",immediately.parameters={storySource:{source:"<Immediately />"}};const onDemandAndResolveOnClear=()=>(0,jsx_runtime.jsx)(OnDemandAndResolveOnClear,{});onDemandAndResolveOnClear.storyName="OnDemandAndResolveOnClear",onDemandAndResolveOnClear.parameters={storySource:{source:"<OnDemandAndResolveOnClear />"}};const componentMeta={title:"Timing/useScheduledTimeout",parameters:{chromatic:{disableSnapshot:!0}},tags:["stories-mdx"],includeStories:["immediately","onDemandAndResolveOnClear"]};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs={...componentMeta.parameters.docs||{},page:function MDXContent(props={}){const{wrapper:MDXLayout}=Object.assign({},(0,lib.ah)(),props.components);return MDXLayout?(0,jsx_runtime.jsx)(MDXLayout,{...props,children:(0,jsx_runtime.jsx)(_createMdxContent,{...props})}):_createMdxContent(props)}};const use_scheduled_timeout_stories=componentMeta},"./node_modules/react/cjs/react-jsx-runtime.production.min.js":(__unused_webpack_module,exports,__webpack_require__)=>{var f=__webpack_require__("./node_modules/react/index.js"),g=60103;if(exports.Fragment=60107,"function"==typeof Symbol&&Symbol.for){var h=Symbol.for;g=h("react.element"),exports.Fragment=h("react.fragment")}var m=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n=Object.prototype.hasOwnProperty,p={key:!0,ref:!0,__self:!0,__source:!0};function q(c,a,k){var b,d={},e=null,l=null;for(b in void 0!==k&&(e=""+k),void 0!==a.key&&(e=""+a.key),void 0!==a.ref&&(l=a.ref),a)n.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:g,type:c,key:e,ref:l,props:d,_owner:m.current}}exports.jsx=q,exports.jsxs=q},"./node_modules/react/jsx-runtime.js":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__("./node_modules/react/cjs/react-jsx-runtime.production.min.js")}}]);