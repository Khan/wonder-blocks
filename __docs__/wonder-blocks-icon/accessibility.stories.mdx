import {Meta, Story, Canvas} from "@storybook/blocks";

import Color from "@khanacademy/wonder-blocks-color";
import {View} from "@khanacademy/wonder-blocks-core";
import {PhosphorIcon} from "@khanacademy/wonder-blocks-icon";
import Spacing from "@khanacademy/wonder-blocks-spacing";
import {LabelMedium} from "@khanacademy/wonder-blocks-typography";

import {IconMappings} from "./phosphor-icon.argtypes";

<Meta
    title="Icon / Accessibility"
    component={PhosphorIcon}
    parameters={{
        previewTabs: {
            canvas: {hidden: true},
        },
        viewMode: "docs",
        chromatic: {
            // Disables chromatic testing for these stories.
            disableSnapshot: true,
        },
    }}
/>

## Icon Accessibility

### Rules of Thumb

-   Use familiar or commonly used icons.
-   Each icon should convey a single meaning.
-   Icons should be easy to see.
-   The color contrast should pass WCAG.
    -   At least 3:1 contrast ratio for icons.
-   Ideally, an icon should be accompanied by text. However, if an icon
    is not accompanied by text, provide alt text.
    -   Do not provide alt text for decorative icons. Set the alt text
        to an empty string (`""`).
    -   The `title` attribute is often used to display a description on mouse
        hover, but please note that use of the `title` attribute is discouraged
        as titles are not available to keyboard-only or touch-only users.
        More information can be found in the [References](#references) below.
-   Icons should go on the opposite side as left-to-right languages
    for right-to-left languages.
    -   The icon may also need to be mirrored.

More information about all these points can be found in the
[References](#references) below.

### Demo: Contrast

<Canvas>
    <Story name="Icon contrast">
        <View style={{flexDirection: "row", marginBottom: Spacing.xSmall_8}}>
            <LabelMedium>High contrast icon (GOOD):</LabelMedium>
            <PhosphorIcon
                icon={IconMappings.checkCircle}
                style={{color: Color.blue, marginInlineStart: Spacing.xSmall_8}}
            />
        </View>
        <View style={{flexDirection: "row"}}>
            <LabelMedium>Low contrast icon (BAD):</LabelMedium>
            <PhosphorIcon
                icon={IconMappings.xCircle}
                style={{
                    color: Color.lightBlue,
                    marginInlineStart: Spacing.xSmall_8,
                }}
            />
        </View>
    </Story>
</Canvas>

### Demo: Right-to-left icons

<Canvas>
    <Story name="Right to left icons">
        <View style={{flexDirection: "row", direction: "ltr"}}>
            <PhosphorIcon icon={IconMappings.caretRight} />
            <LabelMedium style={{marginInlineStart: Spacing.xSmall_8}}>
                {"Left to right"}
            </LabelMedium>
        </View>
        <View style={{flexDirection: "row", direction: "rtl"}}>
            <PhosphorIcon icon={IconMappings.caretLeft} />
            <LabelMedium style={{marginInlineStart: Spacing.xSmall_8}}>
                {"دائیں سے بائیں"}
            </LabelMedium>
        </View>
    </Story>
</Canvas>

### References

-   [Use Icons that Help the User - W3](https://www.w3.org/WAI/WCAG2/supplemental/patterns/o1p07-icons-used/)
-   [Bidirectionality - Material](https://m2.material.io/design/usability/bidirectionality.html)
-   [Accessible Icons: How to Make Them for Your Website](https://blog.hubspot.com/website/accessible-icons)
-   [HTML5 Accessibility Chops: title attribute use and abuse](https://www.tpgi.com/html5-accessibility-chops-title-attribute-use-and-abuse/)
-   [Non-text Contrast (Level AA) - W3](https://www.w3.org/WAI/WCAG22/Understanding/non-text-contrast.html)
