{"version":3,"file":"exports.use-latest-ref.stories-90533a07.js","sources":["../../packages/wonder-blocks-core/src/hooks/use-latest-ref.ts","../../__docs__/wonder-blocks-core/exports.use-latest-ref.stories.mdx"],"sourcesContent":["import * as React from \"react\";\n\n/**\n * Return a ref that always contains the `value` passed.\n *\n * The useLatestRef hook returns a ref that always contains the `value` passed\n * to the hook during the most recent render.\n *\n * It can be used to wrap a possibly-changing prop in a stable value that can\n * be passed to useEffect without causing unnecessary re-renders. See the\n * Storybook docs for a usage example.\n */\nexport function useLatestRef<T>(value: T): React.RefObject<T> {\n    const ref = React.useRef(value);\n    ref.current = value;\n    return ref;\n}\n","import {useEffect, useState} from \"react\";\nimport {Meta} from \"@storybook/blocks\";\nimport {useLatestRef, View} from \"@khanacademy/wonder-blocks-core\";\nimport Button from \"@khanacademy/wonder-blocks-button\";\nimport {LabeledTextField} from \"@khanacademy/wonder-blocks-form\";\nimport {Strut} from \"@khanacademy/wonder-blocks-layout\";\nimport Spacing from \"@khanacademy/wonder-blocks-spacing\";\nimport Color from \"@khanacademy/wonder-blocks-color\";\n\n<Meta\n    title=\"Core / Exports / useLatestRef()\"\n    parameters={{\n        chromatic: {\n            disableSnapshot: true,\n        },\n    }}\n/>\n\n# useLatestRef()\n\n```ts\nfunction useLatestRef<T>(value: T): React.RefObject<T>;\n```\n\nThe `useLatestRef` hook returns a ref that always contains the `value` passed\nto the hook during the most recent render.\n\nIt can be used to wrap a possibly-changing prop in a stable value that can\nbe passed to `useEffect`'s dependency array. This can be useful when you don't\nwant the `useEffect` callback to be re-run when the prop changes, but do need\nto use the prop's value inside the `useEffect` callback.\n\n## Example\n\n```ts\nexport function ComponentThatAlertsOnUnmount({message}) {\n    const messageRef = useLatestRef(message);\n    useEffect(() => {\n        return () => alert(messageRef.current);\n    }, [messageRef]);\n    return <p>Message: {message}</p>;\n}\n```\n\nexport function ComponentThatAlertsOnUnmount({message}) {\n    const messageRef = useLatestRef(message);\n    useEffect(() => {\n        return () => alert(messageRef.current);\n    }, [messageRef]);\n    return <p>Message: {message}</p>;\n}\n\nThe component above will `alert()` a message when it unmounts. (If you want to\nimagine a more realistic example, pretend it's sending an analytics event!)\nThe component always alerts the message it was rendering just before unmount,\neven if the message changes during the component's lifespan.\n\nHere it is in action, wrapped in controls that let you change the `message`\nprop and unmount/remount the component.\n\n<Example1 />\n\nexport function Example1() {\n    const [message, setMessage] = useState(\"Hello, world!\");\n    const [isMounted, setIsMounted] = useState(true);\n    const mount = () => setIsMounted(true);\n    const unmount = () => setIsMounted(false);\n    return (\n        <Context>\n            <LabeledTextField\n                label=\"Message\"\n                description=\"An alert will pop up with this message when you click 'Unmount'. You can change the message while the component is mounted.\"\n                value={message}\n                onChange={setMessage}\n            />\n            <Strut size={Spacing.medium_16} />\n            <View style={{flexDirection: \"row\", gap: Spacing.xSmall_8}}>\n                {isMounted && <Button onClick={unmount}>Unmount</Button>}\n                {!isMounted && <Button onClick={mount}>Mount</Button>}\n            </View>\n            <Strut size={Spacing.medium_16} />\n            <Context>\n                {isMounted && (\n                    <ComponentThatAlertsOnUnmount message={message} />\n                )}\n            </Context>\n        </Context>\n    );\n}\n\nexport function Context({children}) {\n    return (\n        <View\n            style={{\n                borderRadius: 5,\n                border: \"1px solid #ccc\",\n                boxShadow: \"inset 1px 1px 6px #0001\",\n                padding: Spacing.medium_16,\n                background: Color.offWhite,\n            }}\n        >\n            {children}\n        </View>\n    );\n}\n"],"names":["useLatestRef","value","ref","React.useRef","ComponentThatAlertsOnUnmount","message","_components","_provideComponents","messageRef","useEffect","_jsxs","Example1","setMessage","useState","isMounted","setIsMounted","mount","unmount","Context","_jsx","LabeledTextField","Strut","Spacing","View","Button","children","Color","_createMdxContent","props","_Fragment","Meta","MDXContent","MDXLayout","__page","componentMeta","__namedExportsOrder"],"mappings":"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"}