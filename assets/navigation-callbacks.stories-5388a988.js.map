{"version":3,"file":"navigation-callbacks.stories-5388a988.js","sources":["../../__docs__/wonder-blocks-button/navigation-callbacks.stories.mdx"],"sourcesContent":["import {Meta, Story, Canvas} from \"@storybook/blocks\";\nimport {StyleSheet} from \"aphrodite\";\nimport {MemoryRouter, Route, Switch} from \"react-router-dom\";\n\nimport Button from \"@khanacademy/wonder-blocks-button\";\nimport {View} from \"@khanacademy/wonder-blocks-core\";\n\nimport {styles} from \"./button.stories\";\n\n<Meta\n    title=\"Button / Navigation Callbacks\"\n    component={Button}\n    parameters={{\n        previewTabs: {\n            canvas: {hidden: true},\n        },\n        viewMode: \"docs\",\n        chromatic: {\n            // Disables chromatic testing for these stories.\n            disableSnapshot: true,\n        },\n    }}\n/>\n\n# Running Callbacks on Navigation\n\nSometimes you may need to run some code and also navigate when the user\nclicks the button. For example, you might want to send a request to the\nserver and also send the user to a different page. You can do this by\npassing in a URL to the `href` prop and also passing in a callback\nfunction to either the `onClick`, `beforeNav`, or `safeWithNav` prop.\nWhich prop you choose depends on your use case.\n\n-   `onClick` is guaranteed to run to completion before navigation starts,\n    but it is not async aware, so it should only be used if all of the code\n    in your callback function executes synchronously.\n\n-   `beforeNav` is guaranteed to run async operations before navigation\n    starts. You must return a promise from the callback function passed in\n    to this prop, and the navigation will happen after the promise\n    resolves. If the promise rejects, the navigation will not occur.\n    This prop should be used if it's important that the async code\n    completely finishes before the next URL starts loading.\n\n-   `safeWithNav` runs async code concurrently with navigation when safe,\n    but delays navigation until the async code is finished when\n    concurrent execution is not safe. You must return a promise from the\n    callback function passed in to this prop, and Wonder Blocks will run\n    the async code in parallel with client-side navigation or while opening\n    a new tab, but will wait until the async code finishes to start a\n    server-side navigation. If the promise rejects the navigation will\n    happen anyway. This prop should be used when it's okay to load\n    the next URL while the async callback code is running.\n\nThis table gives an overview of the options:\n\n| Prop        | Async safe? | Completes before navigation? |\n| ----------- | ----------- | ---------------------------- |\n| onClick     | no          | yes                          |\n| beforeNav   | yes         | yes                          |\n| safeWithNav | yes         | no                           |\n\nIt is possible to use more than one of these props on the same element.\nIf multiple props are used, they will run in this order: first `onClick`,\nthen `beforeNav`, then `safeWithNav`. If both `beforeNav` and `safeWithNav`\nare used, the `safeWithNav` callback will not be called until the\n`beforeNav` promise resolves successfully. If the `beforeNav` promise\nrejects, `safeWithNav` will not be run.\n\nIf the `onClick` handler calls `preventDefault()`, then `beforeNav`\nand `safeWithNav` will still run, but navigation will not occur.\n\nexport const BeforeNavCallbacks = () => (\n    <MemoryRouter>\n        <View style={styles.row}>\n            <Button\n                href=\"/foo\"\n                style={styles.button}\n                beforeNav={() =>\n                    new Promise((resolve, reject) => {\n                        setTimeout(resolve, 1000);\n                    })\n                }\n            >\n                beforeNav, client-side nav\n            </Button>\n            <Button\n                href=\"/foo\"\n                style={styles.button}\n                skipClientNav={true}\n                beforeNav={() =>\n                    new Promise((resolve, reject) => {\n                        setTimeout(resolve, 1000);\n                    })\n                }\n            >\n                beforeNav, server-side nav\n            </Button>\n            <Button\n                href=\"https://google.com\"\n                style={styles.button}\n                skipClientNav={true}\n                beforeNav={() =>\n                    new Promise((resolve, reject) => {\n                        setTimeout(resolve, 1000);\n                    })\n                }\n            >\n                beforeNav, open URL in new tab\n            </Button>\n            <Switch>\n                <Route path=\"/foo\">\n                    <View id=\"foo\">Hello, world!</View>\n                </Route>\n            </Switch>\n        </View>\n    </MemoryRouter>\n);\n\nexport const SafeWithNavCallbacks = () => (\n    <MemoryRouter>\n        <View style={styles.row}>\n            <Button\n                href=\"/foo\"\n                style={styles.button}\n                safeWithNav={() =>\n                    new Promise((resolve, reject) => {\n                        setTimeout(resolve, 1000);\n                    })\n                }\n            >\n                safeWithNav, client-side nav\n            </Button>\n            <Button\n                href=\"/foo\"\n                style={styles.button}\n                skipClientNav={true}\n                safeWithNav={() =>\n                    new Promise((resolve, reject) => {\n                        setTimeout(resolve, 1000);\n                    })\n                }\n            >\n                safeWithNav, server-side nav\n            </Button>\n            <Button\n                href=\"https://google.com\"\n                style={styles.button}\n                skipClientNav={true}\n                safeWithNav={() =>\n                    new Promise((resolve, reject) => {\n                        setTimeout(resolve, 1000);\n                    })\n                }\n            >\n                safeWithNav, open URL in new tab\n            </Button>\n            <Switch>\n                <Route path=\"/foo\">\n                    <View id=\"foo\">Hello, world!</View>\n                </Route>\n            </Switch>\n        </View>\n    </MemoryRouter>\n);\n\n## Stories\n\n### beforeNav Callbacks\n\nThese buttons always wait until the async callback code completes before\nstarting navigation.\n\n<Canvas>\n    <Story name=\"beforeNav Callbacks\">{BeforeNavCallbacks.bind({})}</Story>\n</Canvas>\n\n### safeWithNav Callbacks\n\nIf the `onClick` callback calls `preventDefault()`, then navigation will not occur.\n\n<Canvas>\n    <Story name=\"safeWithNav Callbacks\">{SafeWithNavCallbacks.bind({})}</Story>\n</Canvas>\n"],"names":["BeforeNavCallbacks","_jsx","MemoryRouter","_jsxs","View","styles","Button","resolve","reject","Switch","Route","SafeWithNavCallbacks","_createMdxContent","props","_components","_provideComponents","_Fragment","Meta","Canvas","Story","MDXContent","MDXLayout","beforeNavCallbacks","safeWithNavCallbacks","componentMeta","__namedExportsOrder"],"mappings":"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"}